In the present paper, we characterize all possible Hilbert functions of graded ideals in a polynomial ring whose regularity is smaller than or equal to d, where d is a positive integer. In addition, we prove the following result which is a generalization of Bigatti, Hulett and Pardue's result: Let p \geq 0 and d>0 be integers. If the base field is a field of characteristic 0 and there is a graded ideal I whose projective dimension \mathrm{proj\ dim}(I) is smaller than or equal to p and whose regularity \mathrm{reg}(I) is smaller than or equal to d, then there exists a monomial ideal L having the maximal graded Betti numbers among graded ideals J which have the same Hilbert function as I and which satisfy \mathrm{proj dim}(J) \leq p and \mathrm{reg}(J) \leq d. We also prove the same fact for squarefree monomial ideals. The main methods for proofs are generic initial ideals and combinatorics on strongly stable ideals.