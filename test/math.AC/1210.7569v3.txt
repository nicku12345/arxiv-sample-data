The G-parking function ideal M_G of a directed multigraph G is a monomial ideal which encodes some of the combinatorial information of G. It is an initial ideal of the toppling ideal I_G, a lattice ideal intimately related to the chip-firing game on a graph. Both ideals were first studied by Cori, Rossin, and Salvy. A minimal free resolution for M_G was given by Postnikov and Shaprio in the case when G is saturated, i.\,e., whenever there is at least one edge (u,v) for every ordered pair of distinct vertices u and v. They also raised the problem of an explicit description of the minimal free resolution in the general case. In this paper, we give a minimal free resolution of M_G for any undirected multigraph G, as well as for a family of related ideals including the toppling ideal I_G. This settles a conjecture of Manjunath and Sturmfels, as well as a conjecture of Perkinson and Wilmes.