We prove a comparison formula for the Donaldson-Thomas curve-counting invariants of two smooth and projective Calabi-Yau threefolds related by a flop. By results of Bridgeland any two such varieties are derived equivalent. Furthermore there exist pairs of categories of perverse coherent sheaves on both sides which are swapped by this equivalence. Using the theory developed by Joyce we construct the motivic Hall algebras of these categories. These algebras provide a bridge relating the invariants on both sides of the flop.