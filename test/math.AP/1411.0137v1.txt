Let M be a complete non-compact Riemannian manifold satisfying the doubling volume property   as well as a Gaussian upper bound for the corresponding heat kernel. We study the boundedness of the Riesz transform d\Delta ^{-\frac{1}{2}} on both Hardy spaces H^p and Lebesgue spaces L^p under two different conditions on the negative part of the Ricci curvature R^-.   First we prove that if R^- is \alpha-subcritical for some \alpha \in [0,1), then the Riesz transform d^*\Delta^{-\frac{1}{2}} on differential 1-forms is bounded from the associated Hardy space H^p_{\overrightarrow{\Delta}}(\Lambda^1T^*M) to L^p(M) for all p\in [1,2].   As a consequence, the Riesz transform (on functions) is bounded on  L^p for all p\in (1,p_0) where p_0>2 depends on \alpha and the constant appearing in the doubling property. Second, we prove that if \int_0^1 \left\|\frac{|R^-|^{\frac{1}{2}}}{v(\cdot,\ \sqrt{t})^{\frac{1}{p_1}}}\right\|_{p_1}\frac{dt}{\sqrt{t}}+\int_1^\infty \left\|\frac{|R^-|^{\frac{1}{2}}}{v(\cdot,\ \sqrt{t})^{\frac{1}{p_2}}}\right\|_{p_2}\frac{dt}{\sqrt{t}}<\infty, for some p_1>2 and p_2>3, then the Riesz transform d\Delta^{-\frac{1}{2}} is bounded on L^p for all 1<p<p_2. In the particular case where v(x, r) \ge C r^D for all r \ge 1 and |R^-| \in L^{D/2 -\eta} \cap L^{D/2 + \eta} for some \eta > 0, then d\Delta^{-\frac{1}{2}} is bounded on L^p for all 1<p< D.   Furthermore, we study the boundedness of the Riesz transform of Schr\"odinger operators A=\Delta+V on L^p for p>2 under conditions on R^- and the potential V. We prove both positive and negative results on the boundedness of dA^{-\frac{1}{2}} on L^p