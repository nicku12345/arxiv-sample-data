Let I be an open interval, M be a real manifold, T*M its cotangent bundle and \Phi={\phi_t}, t in I, a homogeneous Hamiltonian isotopy of T*M defined outside the zero-section. Let \Lambda be the conic Lagrangian submanifold associated with \Phi (\Lambda is a subset of T*M x T*M x T*I). We prove the existence and unicity of a sheaf K on MxMxI whose microsupport is contained in the union of \Lambda and the zero-section and whose restriction to t=0 is the constant sheaf on the diagonal of MxM. We give applications of this result to problems of non displaceability in contact and symplectic topology. In particular we prove that some strong Morse inequalities are stable by Hamiltonian isotopies and we also give results of non displaceability for positive isotopies in the contact setting. In this new version we suppress one hypothesis in the main theorem and we extend the result of non displaceability for positive isotopies.