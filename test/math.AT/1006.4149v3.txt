On a polarized compact symplectic manifold endowed with an action of a compact Lie group, in analogy with geometric invariant theory, one can define the space of invariant functions of degree k. A central statement in symplectic geometry, the quantization commutes with reduction hypothesis, is equivalent to saying that the dimension of these invariant functions depends polynomially on k. This statement was proved by Meinrenken and Sjamaar under positivity conditions. In this paper, we give a new proof of this polynomiality property. The proof is based on a study of the Atiyah-Bott fixed point formula from the point of view of the theory of partition functions, and a technique for localizing positivity.