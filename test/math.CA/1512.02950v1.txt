We prove in the context of local Tb theorems with L^p type testing conditions an improved version of Cotlar's inequality. This is related to the problem of removing the so called buffer assumption of Hyt\"onen-Nazarov, which is the final barrier for the full solution of S. Hofmann's problem. We also investigate the problem of extending the Hyt\"onen-Nazarov result to non-homogeneous measures. We work not just with the Lebesgue measure but with measures \mu in \mathbb{R}^d satisfying \mu(B(x,r)) \le Cr^n, n \in (0, d]. The range of exponents in the Cotlar type inequality depend on n. Without assuming buffer we get the full range of exponents p,q \in (1,2] for measures with n \le 1, and in general we get p, q \in [2-\epsilon(n), 2], \epsilon(n) > 0. Consequences for (non-homogeneous) local Tb theorems are discussed.