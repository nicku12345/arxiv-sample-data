In this paper we show that if \mu is a Borel measure in \mathbb R^{n+1} with growth of order n, so that the n-dimensional Riesz transform R_\mu is bounded in L^2(\mu), and B\subset\mathbb R^{n+1} is a ball with \mu(B)\approx r(B)^n such that: (a) there is some n-plane L passing through the center of B such that for some \delta>0 small enough, it holds \int_B \frac{dist(x,L)}{r(B)}\,d\mu(x)\leq \delta\,\mu(B), (b) for some constant \epsilon>0 small enough, \int_B |R_\mu1(x) - m_{\mu,B}(R_\mu1)|^2\,d\mu(x) \leq \epsilon \,\mu(B), where m_{\mu,B}(R_\mu1) stands for the mean of R_\mu1 on B with respect to \mu; then there exists a uniformly n-rectifiable subset \Gamma, with \mu(\Gamma\cap B)\gtrsim \mu(B), and so that \mu|_\Gamma is absolutely continuous with respect to H^n|_\Gamma. This result is an essential tool to solve an old question on a two phase problem for harmonic measure in a subsequent paper by Azzam, Mourgoglou and Tolsa.