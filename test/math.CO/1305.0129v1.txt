We generalize the work of Fomin, Greene, Reiner, and Shimozono on balanced labellings in two directions: (1) we define the diagrams of affine permutations and the balanced labellings on them; (2) we define the set-valued version of the balanced labellings. We show that the column-strict balanced labellings on the diagram of an affine permutation yield the affine Stanley symmetric function defined by Lam, and that the column-strict set-valued balanced labellings yield the affine stable Grothendieck polynomial of Lam. Moreover, once we impose suitable flag conditions, the flagged column-strict set-valued balanced labellings on the diagram of a finite permutation give a monomial expansion of the Grothendieck polynomial of Lascoux and Sch\"{u}tzenberger. We also give a necessary and sufficient condition for a diagram to be an affine permutation diagram.