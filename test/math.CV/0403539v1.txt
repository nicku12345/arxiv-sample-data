In the present paper, we associate the techniques of the Lewy-Pinchuk reflection principle with the Behnke-Sommer continuity principle. Extending a so-called reflection function to a parameterized congruence of Segre varieties, we are led to studying the envelope of holomorphy of a certain domain covered by a smooth Levi-flat ``hat''. In our main theorem, we show that every C^infty-smooth CR diffeomorphism h: M to M' between two globally minimal real analytic hypersurfaces in C^n (n >1) is real analytic at every point of M if M' is holomorphically nondegenerate. More generally, we establish that the reflection function R_h' associated to such a C^infty-smooth CR diffeomorphism between two globally minimal hypersurfaces in C^n (n > 1) always extends holomorphically to a neighborhood of the graph of \bar{h} in M\times \bar{M}', without any nondegeneracy condition on M'. This gives a new version of the Schwarz symmetry principle in several complex variables. Finally, as an appendix, we show that every C^infty-smooth CR mapping h: M to M' between two real analytic hypersurfaces containing no complex curves is real analytic at every point of M, without any rank condition on h. This answers a conjecture, explicitely stated for C^infty-smooth maps at p.~328 of the survey article: S.M. Baouendi, P. Ebenfelt and L.-P. Rothschild, Bull. Amer. Math. Soc. (N.S.) 37 (2000), no. 3, 309--336. Importantly, notice that a much stronger result, valid for continuous maps, has been obtained by K. Diederich and S. Pinchuk in: Michigan Math. J. {\bf 51} (2003), no. 1, 111--140; no.~3, 667--668.