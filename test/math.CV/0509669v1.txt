Let M be a complex manifold and S\subset M a (possibly singular) subvariety of M. Let f\colon M\to M be a holomorphic map such that f restricted to S is the identity. We show that one can associate to f a holomorphic section X_f of a sheaf related to the embedding of S in M and that such a section reads the dynamical behavior of f along S. In particular we prove that under generic hypotheses the canonical section X_f induces a holomorphic action in the sense of Bott on the normal bundle of (the regular part of) S in M and this allows to obtain for holomorphic self-maps with non- isolated fixed points index theorems similar to Camacho-Sad, Baum-Bott and variation index theorems for holomorphic foliations. Finally we apply our index theorems to obtain information about topology and dynamics of holomorphic self-maps of surfaces with a compact curve of fixed points.