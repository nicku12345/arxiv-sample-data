We describe a general construction providing index theorems localizing the Chern classes of the normal bundle of a subvariety inside a complex manifold. As particular instances of our construction we recover both Lehmann-Suwa's generalization of the classical Camacho-Sad index theorem for holomorphic foliations and our index theorem for holomorphic maps with positive dimensional fixed point set. Furthermore, we also obtain generalizations of recent index theorems of Camacho-Movasati-Sad and Camacho-Lehmann for holomorphic foliations transversal to a subvariety.