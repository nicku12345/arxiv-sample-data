We study the smooth self-maps f of \times a-invariant sets X\subseteq[0,1]. Under various assumptions we show that this forces \log f'(x)/\log a\in\mathbb{Q} at many points in X. Our method combines scenery flow methods and equidistribution results in the positive entropy case, where we improve previous work of the author and Shmerkin, with a new topological variant of the scenery flow which applies in the zero-entropy case.