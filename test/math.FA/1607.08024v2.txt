Let R be an expanding matrix with integer entries and let B,L be finite integer digit sets so that (R,B,L) form a Hadamard triple on {\br}^d in the sense that the matrix  \frac{1}{\sqrt{|\det R|}}\left[e^{2\pi i \langle R^{-1}b,\ell\rangle}\right]_{\ell\in L,b\in B}    is unitary. We prove that the associated fractal self-affine measure \mu = \mu(R,B) obtained by an infinite convolution of atomic measures  \mu(R,B) = \delta_{R^{-1} B}\ast\delta_{R^{-2}B}\ast\delta_{R^{-3}B}\ast...  is a spectral measure, i.e., it admits an orthonormal basis of exponential functions in L^2(\mu). This settles a long-standing conjecture proposed by Jorgensen and Pedersen and studied by many other authors. Moreover, we also show that if we relax the Hadamard triple condition to an almost-Parseval-frame condition, then we obtain a sufficient condition for a self-affine measure to admit Fourier frames.