A variety of groups does not contain all metabelian groups if and only if there is an absolute bound for the nilpotency classes of powerful p-groups in the given variety. Similarly, a variety contains only finitely many finite p-groups of any given coclass if and only if not every group that is an extension of an abelian group by an elementary abelian p-group belongs to that variety.