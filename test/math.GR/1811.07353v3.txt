The algebraic structure of the group generated by the encryption functions of a block cipher depends on the key schedule algorithm used for generating the round keys. For such a reason, in general, studying this group does not appear to be an easy task. Previous works, focusing on the algebraic properties of groups associated to a cipher, have studied the group generated by the round functions of the cipher considering independent round keys. In this paper, we want to study the more realistic group generated by the encryption functions, where the key schedule satisfies certain requirements. In this contest, we are able to identify sufficient conditions that permit to guarantee the primitivity of this group and the security of the cipher with respect to the partition-based trapdoor. This type of trapdoor has been recently introduced by Bannier et al. (2016) and it is a generalization of that introduced by Paterson in 1999.