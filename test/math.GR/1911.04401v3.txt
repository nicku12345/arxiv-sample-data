The paper is concerned with Kropholler's conjecture on splitting a finitely generated group over a codimension-1 subgroup. For a subgroup H of a group G, we define the notion of "finite splitting height" which generalises the finite-height property. By considering the dual CAT(0) cube complex associated to a codimension-1 subgroup H in G, we show that the Kropholler-Roller conjecture holds when H has finite splitting height in G. Examples of subgroups of finite height are stable subgroups or more generally strongly quasiconvex subgroups. Examples of subgroups of finite splitting height include relatively quasiconvex subgroups of relatively hyperbolic groups with virtually polycyclic peripheral subgroups. In particular, our results extend Stallings' theorem and generalise a theorem of Sageev on decomposing a hyperbolic group by quasiconvex subgroups.