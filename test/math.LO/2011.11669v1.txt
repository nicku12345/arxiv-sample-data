The aim of this paper is to generalize and improve two of the main model-theoretic results of "Stable group theory and approximate subgroups" by E. Hrushovski to the context of piecewise hyperdefinable sets. The first one is the existence of Lie cores. The second one is the stabilizer theorem. In the process, a systematic study of the structure of piecewise hyperdefinable sets is developed. In particular, we show the most significant properties of their logic topologies.