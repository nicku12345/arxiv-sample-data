We use the homological perturbation lemma to produce explicit formulas computing the class in the twisted de Rham complex represented by an arbitrary polynomial. This is a non-asymptotic version of the method of Feynman diagrams. In particular, we explain that phenomena usually thought of as particular to asymptotic integrals in fact also occur exactly: integrals of the type appearing in quantum field theory can be reduced in a totally algebraic fashion to integrals over an Euler--Lagrange locus, provided this locus is understood in the scheme-theoretic sense, so that imaginary critical points and multiplicities of degenerate critical points contribute.