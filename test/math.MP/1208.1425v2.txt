Hamiltonian operators are gauge dependent. For overcome this difficulty we reexamined the effect of a gauge transformation on Schr\"odinger and Dirac equations. We show that the gauge invariance of the operator H-i\hbar\frac{\partial}{\partial t} provides a way to find the energy operator from first principles. In particular, when the system has stationary states the energy operator can be identified without ambiguities for non-relativistic and relativistic quantum mechanics. Finally, we examine other approaches finding that in the case in which the electromagnetic field is time independent, the energy operator obtained here is the same as one recently proposed by Chen et al. [1].