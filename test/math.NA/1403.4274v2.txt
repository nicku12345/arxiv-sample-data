This paper deals with the numerical integration of Hamiltonian systems in which a stiff anharmonic potential causes highly oscillatory solution behavior with solution-dependent frequencies. The impulse method, which uses micro- and macro-steps for the integration of fast and slow parts, respectively, does not work satisfactorily on such problems. Here it is shown that variants of the impulse method with suitable projection preserve the actions as adiabatic invariants and yield accurate approximations, with macro-stepsizes that are not restricted by the stiffness parameter.