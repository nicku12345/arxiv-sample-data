In this paper, based on an ideal of Tian, we establish a new sufficient condition for a positive integer to be a congruent number in terms of Legendre symbols of prime factors of the positive integer. Our criterion generalizes previous criterions of Heegner, and Birch--Stephens, Monsky, and Tian, and conjecturally provides a list of positive density of congruent numbers. Our method of proving our criterion is to give formulae for the analytic Tate--Shafarevich number in terms of the so-called genus periods and genus points. These formulae are derived from the Waldspurger formula and the generalized Gross--Zagier formula of Yuan-Zhang-Zhang.