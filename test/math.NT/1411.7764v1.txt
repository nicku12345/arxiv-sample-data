Improving earlier work of Balasubramanian, Conrey and Heath-Brown, we obtain an asymptotic formula for the mean-square of the Riemann zeta-function times an arbitrary Dirichlet polynomial of length T^{1/2 + \delta}, with \delta = 0.01515.... As an application we obtain an upper bound of the correct order of magnitude for the third moment of the Riemann zeta-function. We also refine previous work of Deshouillers and Iwaniec, obtaining asymptotic estimates in place of bounds. Using the work of Watt, we compute the mean-square of the Riemann zeta-function times a Dirichlet polynomial of length going up to T^{3/4} provided that the Dirichlet polynomial assumes a special shape. Finally, we exhibit a conjectural estimate for trilinear sums of Kloosterman fractions which implies the Lindelof Hypothesis.