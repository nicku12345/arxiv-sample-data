We study the mean square of sums of the kth divisor function d_k(n) over short intervals and arithmetic progressions for the rational function field over a finite field of q elements. In the limit as q\rightarrow\infty we establish a relationship with a matrix integral over the unitary group. Evaluating this integral enables us to compute the mean square of the sums of d_k(n) in terms of a lattice point count. This lattice point count can in turn be calculated in terms of certain polynomials, which we analyse. Our results suggest general conjectures for the corresponding classical problems over the integers, which agree with the few cases where the answer is known.