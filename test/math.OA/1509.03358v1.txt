Results of Haagerup and Schultz (2009) about existence of invariant subspaces that decompose the Brown measure are extended to a large class of unbounded operators affiliated to a tracial von Neumann algebra. These subspaces are used to decompose an arbitrary operator in this class into the sum of a normal operator and a spectrally negligible operator. This latter result is used to prove that, on a bimodule over a tracial von Neumann algebra that is closed with respect to logarithmic submajorization, every trace is spectral, in the sense that the trace value on an operator depends only on the Brown measure of the operator.