We establish a one to one correspondence between idempotent states on a locally compact quantum group G and integrable coideals in the von Neumann algebra of bounded measurable functions on G that are preserved by the scaling group. In particular we show that there is a 1-1 correspondence between idempotent states on G and psi-expected left invariant von Neumann subalgebras of bounded measurable functions on G. We characterize idempotent states of Haar type as those corresponding to integrable normal coideals preserved by the scaling group. We also establish a one to one correspondence between open subgroups of G and convolutionally central idempotent states on the dual of G. Finally we characterize coideals corresponding to open quantum subgroups of G as those that are normal and admit an atom. As a byproduct of this study we get a number of universal lifting results for Podles condition, normality and regularity and we generalize number of results known before to hold under the coamenability assumption.