We consider an energy provider whose goal is to simultaneously set revenue-maximizing prices and meet a peak load constraint. In our bilevel setting, the provider acts as a leader (upper level) that takes into account a smart grid (lower level) that minimizes the sum of users' disutilities. The latter bases its decisions on the hourly prices set by the leader, as well as the schedule preferences set by the users for each task. Considering both the monopolistic and competitive situations, we illustrate numerically the validity of the approach, which achieves an 'optimal' trade-off between three objectives: revenue, user cost, and peak demand.