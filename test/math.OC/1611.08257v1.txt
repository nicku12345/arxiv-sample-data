We consider optimization problems with a disjunctive structure of the constraints. Prominent examples of such problems are mathematical programs with equilibrium constraints or vanishing constraints. Based on the concepts of directional subregularity and their characterization by means of objects from generalized differentiation, we obtain the new stationarity concept of extended M-stationarity, which turns out to be an equivalent dual characterization of B-stationarity. These results are valid under a very weak constraint qualification of Guignard type which is usually very difficult to verify. We also state a new constraint qualification which is a little bit stronger but verifiable. Further we present second-order optimality conditions, both necessary and sufficient. Finally we apply these results to the special case of mathematical programs with equilibrium constraints and compute explicitly all the objects from generalized differentiation. For this type of problems we also introduce the concept of strong M-stationarity which builds a bridge between S-stationarity and M-stationarity.