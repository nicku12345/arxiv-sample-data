Wind power integration is an essential problem for modern power industry. In this paper, we develop a novel bilevel mixed integer optimization model to investigate wind power generation planning problem in an electricity market environment with topology control operations. Different from existing formulations, the lower level market clearing problem introduces binary variables to model line switching decisions, which have been proven very effective to improve transmission capability under different load profiles. To solve this challenging bilevel mixed integer program, a recent decomposition method is customized and a couple of enhancement techniques based on grid structure are designed. Through computing instances from typical IEEE test beds, our solution methods demonstrate a strong solution capacity. Also, we observe that applying topology control on a small number of lines could be very helpful to reduce wind power curtailment and improve the wind penetration level.