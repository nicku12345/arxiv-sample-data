We consider a branching model in discrete time where each individual has a trait in some general state space. Both the reproduction law and the trait inherited by the offsprings may depend on the trait of the mother and the environment. We study the long time behavior of the population and the ancestral lineage of typical individuals under general assumptions, which we specify for applications to some models motivated by biology. Our results focus on the growth rate, the trait distribution among the population for large time, so as local densities and the position of extremal individuals. The approach consists in comparing the branching Markov chain to a well chosen (possibly non-homogeneous) Markov chain.