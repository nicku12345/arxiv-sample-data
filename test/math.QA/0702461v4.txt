Let D be a holomorphic differential operator acting on sections of a holomorphic vector bundle on an n-dimensional compact complex manifold. We prove a formula, conjectured by Feigin and Shoikhet, for the Lefschetz number of D as the integral over the manifold of a differential form. The class of this differential form is obtained via formal differential geometry from the canonical generator of the Hochschild cohomology of the algebra of differential operators in a formal neighbourhood of a point. If D is the identity, the formula reduces to the Riemann--Roch--Hirzebruch formula.