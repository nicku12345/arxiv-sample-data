The two variable Kostka functions are the scalar products of the Macdonald polynomials with the Schur polynomials with respect to the scalar product which makes the Hall-Littlewood polynomials pairwise orthogonal. A conjecture of Macdonald states that they are polynomials in q and t with non-negative integral coefficients. We prove that the Kostka functions are at least polynomials with integral coefficients. The main idea is to prove an analogous statement for the non-symmetric Macdonald polynomials by establishing recursion relations via the affine Hecke algebra.