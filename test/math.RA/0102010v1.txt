We study a symmetric Markov extension of k-algebras N \into M, a certain kind of Frobenius extension with conditional expectation that is tracial on the centralizer and dual bases with a separability property. We place a depth two condition on this extension, which is essentially the requirement that the Jones tower N \into M \into M_1 \into M_2 can be obtained by taking relative tensor products with centralizers A = C_{M_1}(N) and B = C_{M_2}(M). Under this condition, we prove that N \into M is the invariant subalgebra pair of a weak Hopf algebra action by A, i.e., that N = M^A. The endomorphism algebra M_1 = \End_N M is shown to be isomorphic to the smash product algebra M # A. We also extend results of Szymanski, Vainerman and the second author, and the authors.