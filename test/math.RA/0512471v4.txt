We prove that in a 2-Calabi-Yau triangulated category, each cluster tilting subcategory is Gorenstein with all its finitely generated projectives of injective dimension at most one. We show that the stable category of its Cohen-Macaulay modules is 3-Calabi-Yau. We deduce in particular that cluster-tilted algebras are Gorenstein of dimension at most one, and hereditary if they are of finite global dimension. Our results also apply to the stable (!) endomorphism rings of maximal rigid modules of Geiss-Leclerc-Schroer. In addition, we prove a general result about relative 3-Calabi-Yau duality over non stable endomorphism rings. This strengthens and generalizes the Ext-group symmetries obtained by Geiss-Leclerc-Schroer for simple modules. Finally, we generalize the results on relative Calabi-Yau duality from 2-Calabi-Yau to d-Calabi-Yau categories. We show how to produce many examples of d-cluster tilted algebras.