There are theorems in the literature which are referred as Maschke type theorems, because of the attempt to generalize Maschke's classical theorem. Our remark is that all these theorems are in fact providing sufficient conditions for the separability of a certain forgetful functor. But, unlike classical Maschke's theorem, where the sufficient condition is also necessary, none of these theorems gives any necessary condition for the separability of the forgeful functor in question. Our job is to find a necessary and sufficient condition for the separability of the forgetful functor from the category of Doi-Hopf modules forgetting the comodule structure. As in the classical case, this functor is separable iff exists a certain "integral map" with a normalizing property. As particular cases, improved versions of "Maschke type" theorems are given. Other various applications are given. For example, keeping in mind that the category of Yetter-Drinfel'd modules is also a category of Doi-Hopf modules, we obtain the notion of quantum integral. For H a finite dimensional Hopf algebra, the existence of such a quantum integral is a necessary and sufficient condition for the Drinfel'd double to be a separable extension of H.