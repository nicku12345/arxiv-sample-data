Using the geometric Satake correspondence, the Mirkovic-Vilonen cycles in the affine Grasssmannian give bases for representations of a semisimple group G . We prove that these bases are "perfect", i.e. compatible with the action of the Chevelley generators of the positive half of the Lie algebra g. We compute this action in terms of intersection multiplicities in the affine Grassmannian. We prove that these bases stitch together to a basis for the algebra C[N] of regular functions on the unipotent subgroup. We compute the multiplication in this MV basis using intersection multiplicities in the Beilinson-Drinfeld Grassmannian, thus proving a conjecture of Anderson. In the third part of the paper, we define a map from C[N] to a convolution algebra of measures on the dual of the Cartan subalgebra of g. We characterize this map using the universal centralizer space of G. We prove that the measure associated to an MV basis element equals the Duistermaat-Heckman measure of the corresponding MV cycle. This leads to a proof of a conjecture of Muthiah. Finally, we use the map to measures to compare the MV basis and Lusztig's dual semicanonical basis. We formulate conjectures relating the algebraic invariants of preprojective algebra modules (which underlie the dual semicanonical basis) and geometric invariants of MV cycles. In the appendix, we use these ideas to prove that the MV basis and the dual semicanonical basis do not coincide in SL_6.