We extend the correspondence between Poisson maps and actions of symplectic groupoids, which generalizes the one between momentum maps and hamiltonian actions, to the realm of Dirac geometry. As an example, we show how hamiltonian quasi-Poisson manifolds fit into this framework by constructing an ``inversion'' procedure relating quasi-Poisson bivectors to twisted Dirac structures.