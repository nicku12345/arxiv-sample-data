For a nonsingular projective 3-fold X, we define integer invariants virtually enumerating pairs (C,D) where C\subset X is an embedded curve and D\subset C is a divisor. A virtual class is constructed on the associated moduli space by viewing a pair as an object in the derived category of X. The resulting invariants are conjecturally equivalent, after universal transformations, to both the Gromov-Witten and DT theories of X. For Calabi-Yau 3-folds, the latter equivalence should be viewed as a wall-crossing formula in the derived category.   Several calculations of the new invariants are carried out. In the Fano case, the local contributions of nonsingular embedded curves are found. In the local toric Calabi-Yau case, a completely new form of the topological vertex is described.   The virtual enumeration of pairs is closely related to the geometry underlying the BPS state counts of Gopakumar and Vafa. We prove that our integrality predictions for Gromov-Witten invariants agree with the BPS integrality. Conversely, the BPS geometry imposes strong conditions on the enumeration of pairs.