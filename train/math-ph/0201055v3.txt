We study approximate solutions to the Schr\"odinger equation i\epsi\partial\psi_t(x)/\partial t = H(x,-i\epsi\nabla_x) \psi_t(x) with the Hamiltonian given as the Weyl quantization of the symbol H(q,p) taking values in the space of bounded operators on the Hilbert space \Hi_{\rm f} of fast ``internal'' degrees of freedom. By assumption H(q,p) has an isolated energy band. Using a method of Nenciu and Sordoni \cite{NS} we prove that interband transitions are suppressed to any order in \epsi. As a consequence, associated to that energy band there exists a subspace of L^2(\mathbb{R}^d,\Hi _{\rm f}) almost invariant under the unitary time evolution. We develop a systematic perturbation scheme for the computation of effective Hamiltonians which govern approximately the intraband time evolution. As examples for the general perturbation scheme we discuss the Dirac and Born-Oppenheimer type Hamiltonians and we reconsider also the time-adiabatic theory.