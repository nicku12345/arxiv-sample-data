We study the two-boundary extension of a loop model - corresponding to the dense phase of the O(n) model, or to the Q=n^2 state Potts model - in the critical regime -2 < n < 2. This model is defined on an annulus of aspect ratio \tau. Loops touching the left, right, or both rims of the annulus are distinguished by arbitrary (real) weights which moreover depend on whether they wrap the periodic direction. Any value of these weights corresponds to a conformally invariant boundary condition. We obtain the exact seven-parameter partition function in the continuum limit, as a function of \tau, by a combination of algebraic and field theoretical arguments. As a specific application we derive some new crossing formulae for percolation clusters.