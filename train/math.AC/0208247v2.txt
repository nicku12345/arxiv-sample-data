General revision. In particular the parts concerning involutive bases over rings have been significantly changed. In addition some proofs have been improved.