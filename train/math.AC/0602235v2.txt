It is proved that a noetherian commutative local ring A containing a field is regular if there is a complex M of free A-modules with the following properties: M_i=0 for i not in [0,dim A]; the homology of M has finite length; H_0(M) contains the residue field of A as a direct summand. This result is an essential component in the proofs of the McKay correspondence in dimension 3 and of the statement that threefold flops induce equivalences of derived categories.