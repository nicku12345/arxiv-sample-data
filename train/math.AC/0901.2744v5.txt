We prove that, if F is a coherent sheaf of modules over the source of a morphism f:X->Y of complex-analytic spaces, where Y is smooth, then the stalk of F at a point x in X is flat over R, the local ring of the target at f(x) if and only if the n-fold analytic tensor power of this stalk over R (where n = dim R) has no vertical elements. The result implies that if F is a finite module over a morphism f:X->Y of complex algebraic varieties, where Y is smooth and n=dim Y, then the stalk of F at x is R-flat if and only if its n-fold tensor power is a torsionfree R-module. The latter generalizes a classical freeness criterion of Auslander to modules that are not necessarily finitely generated over the base ring.