Let R be a commutative Noetherian ring. We give criteria for flatness of R-modules in terms of associated primes and torsion-freeness of certain tensor products. This allows us to develop a criterion for regularity if R has characteristic p, or more generally if it has a locally contracting endomorphism. Dualizing, we give criteria for injectivity of R-modules in terms of coassociated primes and (h-)divisibility of certain \Hom-modules. Along the way, we develop tools to achieve such a dual result. These include a careful analysis of the notions of divisibility and h-divisibility (including a localization result), a theorem on coassociated primes across a \Hom-module base change, and a local criterion for injectivity.