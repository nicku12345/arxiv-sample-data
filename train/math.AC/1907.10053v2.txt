The classical lemma of Borel reads: any power series with real coefficients is the Taylor series of a smooth function. Algebraically this means the surjectivity of the completion map at a point, C^\infty(\Bbb{R}^n) \twoheadrightarrow \Bbb{R}[[\underline{x}]]. Similarly, Whitney extension theorem implies the surjectivity of the completion at closed subsets of \Bbb{R}^n.   For various applications one needs the surjectivity of completion for general C^\infty-rings and general filtrations. We establish the necessary and sufficient conditions for this surjectivity.   Moreover, we prove: any element of the completion admits a C^\infty-representative that is real-analytic outside of the locus of completion, has any prescribed vanishing rate "at infinity", and the prescribed positivity behaviour at the finite part. Alternatively, one can impose on the smooth representative a set of (compatible) linear conditions.