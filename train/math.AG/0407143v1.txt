Alexander and Hirschowitz determined the Hilbert function of a generic union of fat points in a projective space when the number of fat points is much bigger than the greatest multiplicity of the fat points. Their method is based on a lemma which determines the limit of a linear system depending on fat points which approach a divisor. On the other hand, Nagata in connection with its counter example to the fourteenth problem of Hilbert determined the Hilbert function H(d) of the union of k^2 points of the same multiplicity m in the plane up to degree d=km. We introduce a new method to determine limits of linear systems. This generalizes the result by Alexander and Hirschowitz. Our main application of this method is the conclusion of the work initiated by Nagata: we compute H(d) for all d. As a second application, we determine the generic successive collision of four fat points of the same multiplicity in the plane.