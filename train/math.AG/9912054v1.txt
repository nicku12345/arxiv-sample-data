Borrowing a reduction principle to a recent preprint of G. Faltings (toroidal resolution of some matrix singularities, 1999), we use Lafforgue's compactification of PGL_r^{N+1}/PGL_r to construct a canonical log-smooth toroidal resolution for the bad reduction in a prime p of Shimura varieties of unitary and symplectic type with parahoric level structures at p. Using this result, non-canonical semi-stable resolutions over Z_p[p^{1/\nu}] can be derived.