Let X be a compact manifold with boundary, and g a scattering metric on X, which may be either of short range or `gravitational' long range type. Thus, g gives X the geometric structure of a complete manifold with an asymptotically conic end. Let H be an operator of the form H = \Delta + P, where \Delta is the Laplacian with respect to g and P is a self-adjoint first order scattering differential operator with coefficients vanishing at the boundary of X and satisfying a `gravitational' condition. We define a symbol calculus for Legendre distributions on manifolds with codimension two corners and use it to give a direct construction of the resolvent kernel of H, R(\sigma + i0), for \sigma on the positive real axis. In this approach, we do not use the limiting absorption principle at any stage; instead we construct a parametrix which solves the resolvent equation up to a compact error term and then use Fredholm theory to remove the error term.