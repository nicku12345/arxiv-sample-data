In this paper we prove the optimal C^{1,1}(B_\frac12)-regularity for a general obstacle type problem  \lap u = f\chi_{\{u\neq 0\}}\textup{in B_1},  under the assumption that f*N is C^{1,1}(B_1), where N is the Newtonian potential. This is the weakest assumption for which one can hope to get C^{1,1}-regularity. As a by-product of the C^{1,1}-regularity we are able to prove that, under a standard thickness assumption on the zero set close to a free boundary point x^0, the free boundary is locally a C^1-graph close to x^0, provided f is Dini. This completely settles the question of the optimal regularity of this problem, that has been under much attention during the last two decades.