We study the global behavior of finite energy solutions to the d-dimensional focusing nonlinear Schr\"odinger equation (NLS), i \partial_t u+\Delta u+ |u|^{p-1}u=0,  with initial data u_0\in H^1,\; x \in R^n. The nonlinearity power p and the dimension d are such that the scaling index s=\frac{d}2-\frac2{p-1} is between 0 and 1, thus, the NLS is mass-supercritical (s>0) and energy-subcritical (s<1).   For solutions with \ME[u_0]<1 (\ME[u_0] stands for an invariant and conserved quantity in terms of the mass and energy of u_0), a sharp threshold for scattering and blowup is given. Namely, if the renormalized gradient \g_u of a solution u to NLS is initially less than 1, i.e., \g_u(0)<1, then the solution exists globally in time and scatters in H^1 (approaches some linear Schr\"odinger evolution as t\to\pm\infty); if the renormalized gradient \g_u(0)>1, then the solution exhibits a blowup behavior, that is, either a finite time blowup occurs, or there is a divergence of H^1 norm in infinite time.   This work generalizes the results for the 3d cubic NLS obtained in a series of papers by Holmer-Roudenko and Duyckaerts-Holmer-Roudenko with the key ingredients, the concentration compactness and localized variance, developed in the context of the energy-critical NLS and Nonlinear Wave equations by Kenig and Merle.