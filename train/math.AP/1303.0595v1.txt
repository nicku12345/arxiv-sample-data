In this paper, we prove second derivative estimates together with classical solvability for the Dirichlet problem of certain Monge-Ampere type equations under sharp hypotheses. In particular we assume that the matrix function in the augmented Hessian is regular in the sense used by Trudinger and Wang in their study of global regularity in optimal transportation [28] as well as the existence of a smooth subsolution. The latter hypothesis replaces a barrier condition also used in their work. The applications to optimal transportation and prescribed Jacobian equations are also indicated.