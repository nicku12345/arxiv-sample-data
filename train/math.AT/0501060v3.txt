This paper, in a sense, completes a series of three papers. In the previous two hep-th/0404013, hep-th/0410293, we have explored the possibility of refining the K-theory partition function in type II string theories using elliptic cohomology. In the present paper, we make that more concrete by defining a fully quantized free field theory based on elliptic cohomology of 10-dimensional spacetime. Moreover, we describe a concrete scenario how this is related to compactification of F-theory on an elliptic curve leading to IIA and IIB theories. We propose an interpretation of the elliptic curve in the context of elliptic cohomology. We discuss the possibility of orbifolding of the elliptic curves and derive certain properties of F-theory. We propose a link of this to type IIB modularity, the structure of the topological Lagrangian of M-theory, and Witten's index of loop space Dirac operators.