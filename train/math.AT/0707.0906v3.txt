We construct a spectral sequence for L2-type cohomology groups of discrete measured groupoids. Based on the spectral sequence, we prove the Hopf-Singer conjecture for aspherical manifolds with poly-surface fundamental groups. More generally, we obtain a permanence result for the Hopf-Singer conjecture under taking fiber bundles whose base space is an aspherical manifold with poly-surface fundamental group. As further sample applications of the spectral sequence, we obtain new vanishing theorems and explicit computations of L2-Betti numbers of groups and manifolds and obstructions to the existence of normal subrelations in measured equivalence relations.