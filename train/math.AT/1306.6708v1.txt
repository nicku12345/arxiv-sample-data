The generalized string topology construction of Gruher and Salvatore assigns to any bundle of E_n-algebras A over a closed oriented manifold M a collection of intersection-type operations on the homology of the total space. These operations are realized by an H_n-ring structure on the Thom spectrum A^{-TM} under the Thom isomorphism. We rigidify and extend this construction to a functor connecting the homotopy theory of spaces and spectra parametrized by M to the homotopy theory of module spectra over the Atiyah-Milnor-Spanier-Whitehead dual M^{-TM} \simeq \bbD M. Then, using an \infty-categorical version of Morita theory, we give an alternative description of our construction in terms of the derived Koszul duality (alias bar-cobar duality) between \Sigma^\infty_+ \Omega M and \bbD M.