We extend the theory of Thom spectra and the associated obstruction theory for orientations in order to support the construction of the string orientation of tmf, the spectrum of topological modular forms. We also develop the analogous theory of Thom spectra and orientations for associative ring spectra. Our work is based on a new model of the Thom spectrum as a derived smash product. An earlier version of this paper was part of arXiv:0810.4535.