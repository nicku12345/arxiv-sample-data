We propose a new method of computing cohomology groups of spaces of knots in \R^n, n \ge 3, based on the topology of configuration spaces and two-connected graphs, and calculate all such classes of order \le 3. As a byproduct we define the higher indices, which invariants of knots in \R^3 define at arbitrary singular knots. More generally, for any finite-order cohomology class of the space of knots we define its principal symbol, which lies in a cohomology group of a certain finite-dimensional configuration space and characterizes our class modulo the classes of smaller filtration.