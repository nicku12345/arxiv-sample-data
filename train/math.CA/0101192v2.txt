In this paper we develop a kind of A_p theory for Calderon-Zygmund operators in a non-homogeneous setting. Let \mu be a Borel measure on \R^d which may be non doubling. The only condition that \mu must satisfy is \mu(B(x,r))\leq Cr^n for all x\in\R^d, r>0 and for some fixed n with 0<n\leq d. We introduce a maximal operator N, which coincides with the maximal Hardy-Littlewood operator if \mu(B(x,r))\approx r^n for x\in\supp(\mu), and we show that all n-dimensional Calderon-Zygmund operators are bounded on L^p(w d\mu) if and only if N is bounded on L^p(w d\mu), for a fixed p\in(1,\infty). Also, we prove that this happens if and only if some conditions of Sawyer type hold. This type of weights do not satisfy a reverse Holder inequality, in general, but some kind of self improving property still holds.