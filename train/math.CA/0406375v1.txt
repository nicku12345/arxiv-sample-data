In a recent paper, Pertti Mattila asked which gauge functions \phi have the property that for any planar Borel set A with positive Hausdorff measure in gauge \phi, the projection of A to almost every line has positive length. We show that integrability near zero of \phi(r)/(r^2), which is known to be sufficient for this property, is also necessary if \phi is regularly varying. Our proof is based on a random construction adapted to the gauge function.