Suppose that G is a locally compact abelian group, and write M(G) for the algebra of bounded, regular, complex-valued measures under convolution. A measure \mu in M(G) is said to be idempotent if \mu * \mu = \mu, or alternatively if the Fourier-Stieltjes transform \mu^ takes only the values 0 and 1. The Cohen-Helson-Rudin idempotent theorem states that a measure \mu is idempotent if and only if the set {r in G^ : \mu^(r) = 1} belongs to the coset ring of G^, that is to say we may write \mu^ as a finite plus/minus 1 combination of characteristic functions of cosets r_j + H_j, where the H_j are open subgroups of G^.   In this paper we show that the number L of such cosets can be bounded in terms of the norm ||\mu||, and in fact one may take L <= \exp\exp(C||\mu||^4). In particular our result is non-trivial even for finite groups.