We give a self-contained proof of the A_2 conjecture, which claims that the norm of any Calderon-Zygmund operator is bounded by the first degree of the A_2 norm of the weight. The original proof of this result by the first author relied on a subtle and rather difficult reduction to a testing condition by the last three authors. Here we replace this reduction by a new weighted norm bound for dyadic shifts - linear in the A_2 norm of the weight and quadratic in the complexity of the shift -, which is based on a new quantitative two-weight inequality for the shifts. These sharp one- and two-weight bounds for dyadic shifts are the main new results of this paper. They are obtained by rethinking the corresponding previous results of Lacey-Petermichl-Reguera and Nazarov-Treil-Volberg. To complete the proof of the A_2 conjecture, we also provide a simple variant of the representation, already in the original proof, of an arbitrary Calderon-Zygmund operator as an average of random dyadic shifts and random dyadic paraproducts. This method of the representation amounts to the refinement of the techniques from nonhomogeneous Harmonic Analysis.