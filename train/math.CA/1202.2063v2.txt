Let (X, d, \mu) be a space of homogeneous type, i.e. the measure \mu satisfies doubling (volume) property with respect to the balls defined by the metric d. Let L be a non-negative self-adjoint operator on L^2(X). Assume that the semigroup of L satisfies the Davies-Gaffney estimates. In this paper, we study the weighted Hardy spaces H^p_{L,w}(X), 0 < p \le 1, associated to the operator L on the space X. We establish the atomic and the molecular characterizations of elements in H^p_{L,w}(X). As applications, we obtain the boundedness on \HL for the generalized Riesz transforms associated to L and for the spectral multipliers of L.