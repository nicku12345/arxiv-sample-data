Local Tb theorems with L^p type testing conditions, which are not scale invariant, have been studied widely in the case of the Lebesgue measure. Until very recently, local Tb theorems in the non-homogeneous case had only been proved assuming scale invariant (L^{\infty} or BMO) testing conditions. The combination of non-scale-invariance and general measures is a delicate issue. In a previous paper we overcame this obstacle in the model case of square functions defined using general measures. In this paper we finally tackle the very demanding case of Calder\'on-Zygmund operators. That is, we prove a non-homogeneous local Tb theorem with L^2 type testing conditions for all Calder\'on-Zygmund operators. In doing so we prove general twisted martingale transform inequalities which turn out to be subtle in our general framework.