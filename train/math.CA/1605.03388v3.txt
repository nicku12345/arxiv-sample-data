We study differentiability properties of Riesz potentials of finite Borel measures in dimension d larger than 2. The Riesz kernel has homogeneity 2-d. In dimension 2 we consider logarithmic potentials. We introduce a notion of differentiability in the capacity sense, capacity being Newtonian capacity in dimension larger than 2 and Wiener capacity in the plane. It turns out that differentiability in the capacity sense at a point is related to the existence of principal values of the measure with respect to the vector valued Riesz potential x/|x|^d of homogeneity 1-d. This leads to Calder\'on-Zygmund theory for non-doubling measures. We prove that the Riesz potential of a finite Borel measure is differentiable in the capacity sense except for a set of zero C^1-harmonic capacity. This result is sharp. Surprisingly in the plane there are two distinct notions of differentiability in the capacity sense. For each of them we obtain the best possible result on the size of the exceptional set in terms of Hausdorff measures. We obtain for dimension larger than 2 results on Peano second order differentiability in the capacity sense with exceptional sets of zero Lebesgue measure. Finally, we apply our results to find a new proof of the fact that equilibrium measure is singular with respect to Lebesgue measure.