By a re-examination of MacMahon's original proof of his celebrated theorem on the distribution of the major indices over permutations, we give a reformulation of his argument in terms of the structure of labeled partitions. In this framework, we are able to establish a decomposition theorem for labeled partitions that leads to a simple bijective proof of Wachs' formula on the q-derangement numbers.