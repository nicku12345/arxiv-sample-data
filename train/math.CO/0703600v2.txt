Let s,t,m,n be positive integers such that sm=tn. Let M(m,s;n,t) be the number of m x n matrices over {0,1,2,...} with each row summing to s and each column summing to t. Equivalently, M(m,s;n,t) counts 2-way contingency tables of order m x n such that the row marginal sums are all s and the column marginal sums are all t. A third equivalent description is that M(m,s;n,t) is the number of semiregular labelled bipartite multigraphs with m vertices of degree s and n vertices of degree t. When m=n and s=t such matrices are also referred to as n x n magic squares with line sums equal to t. We prove a precise asymptotic formula for M(m,s;n,t) which is valid over a range of (m,s;n,t) in which m,n become infinite while remaining approximately equal and the average entry is not too small. This range includes the case where m/n, n/m, s/n and t/m are bounded from below.