The notion of Rees product of posets was introduced by Bj\"orner and Welker, where they study connections between poset topology and commutative algebra. Bj\"orner and Welker conjectured and Jonsson proved that the dimension of the top homology of the Rees product of the truncated Boolean algebra B_n \setminus \{0\} and the n-chain C_n is equal to the number of derangements in the symmetric group \mathfrak S_n. Here we prove a refinement of this result, which involves the Eulerian numbers, and a q-analog of both the refinement and the original conjecture, which comes from replacing the Boolean algebra by the lattice of subspaces of the n-dimensional vector space over the q element field, and involves the (\maj,\exc)-q-Eulerian polynomials studied in previous papers of the authors. Equivariant versions of the refinement and the original conjecture are also proved, as are type BC versions (in the sense of Coxeter groups) of the original conjecture and its q-analog.