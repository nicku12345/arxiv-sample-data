We make a systematic study of a new combinatorial construction called a dual equivalence graph. We axiomatize these graphs and prove that their generating functions are symmetric and Schur positive. By constructing a graph on ribbon tableaux which we transform into a dual equivalence graph, we give a combinatorial proof of the symmetry and Schur positivity of the ribbon tableaux generating functions introduced by Lascoux, Leclerc and Thibon. Using Haglund's formula for the transformed Macdonald polynomials, this also gives a combinatorial formula for the Schur expansion of Macdonald polynomials.