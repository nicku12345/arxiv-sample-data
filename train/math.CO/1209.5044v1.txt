We characterize which graph invariants are partition functions of a spin model over the complex numbers, in terms of the rank growth of associated `connection matrices'.