We develop a general theory of extensions of flat functors along geometric morphisms of toposes, and apply it to the study of the class of theories whose classifying topos is equivalent to a presheaf topos. As a result, we obtain a characterization theorem providing necessary and sufficient semantic conditions for a theory to be of presheaf type. This theorem subsumes all the previous partial results obtained on the subject and has several corollaries which can be used in practice for testing whether a given theory is of presheaf type as well as for generating new examples of theories belonging to this class. Along the way, we establish a number of other results of independent interest, including developments about colimits in the context of indexed categories, expansions of geometric theories and methods for constructing theories classified by a given presheaf topos.