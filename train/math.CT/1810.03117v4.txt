The main purpose of this paper is to give a generalization of Dijkgraaf-Witten theory. Consider a morphism from a smash product of spectra E,F to another spectrum G. We construct a TQFT for E-oriented manifolds using a representative of an F-cohomology class of the classifying space of a finite group. For the case that each of spectra E,F,G is given as the K-theory spectrum KU, we further generalize our construction based on non-commutative settings.