We revisit Kapranov and Voevodsky's idea of spaces modelled on combinatorial pasting diagrams, now as a framework for higher-dimensional rewriting and the basis of a model of weak omega-categories. In the first part, we elaborate on Steiner's theory of directed complexes as a combinatorial foundation. We individuate convenient classes of directed complexes and develop the theory of diagrammatic sets relative to one such class. We study a notion of equivalence internal to a diagrammatic set, and single out as models of weak omega-categories those diagrammatic sets whose every composable diagram is connected by an equivalence to a single cell. We then define a semistrict model providing algebraic composites and study the embedding of strict omega-categories into this model. Finally, we prove a version of the homotopy hypothesis for the infinity-groupoids in the weak model, and exhibit a specific mistake in a proof by Kapranov and Voevodsky that had previously been refuted indirectly.