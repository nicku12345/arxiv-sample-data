In this paper, we study cohomology groups of vector bundles on neighborhoods of a non-pluriharmonic locus in Stein manifolds and in projective manifolds. By using our results, we show variants of the Lefschetz hyperplane theorem.