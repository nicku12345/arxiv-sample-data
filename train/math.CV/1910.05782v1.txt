We give a simplified proof of an optimal version of the Ohsawa-Takegoshi L^2-extension theorem. We follow the variational proof by Berndtsson-Lempert and use the method in the paper of McNeal-Varolin. As an application, we give an optimal estimate for extensions from possibly non-reduced subvarieties.