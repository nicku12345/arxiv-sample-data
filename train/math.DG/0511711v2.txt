We study the equivalence problem of submanifolds with respect to a transitive pseudogroup action. The corresponding differential invariants are determined via formal theory and lead to the notions of k-variants and k-covariants, even in the case of non-integrable pseudogroup. Their calculation is based on the cohomological machinery: We introduce a complex for covariants, define their cohomology and prove the finiteness theorem. This implies the well-known Lie-Tresse theorem about differential invariants. We also generalize this theorem to the case of pseudogroup action on differential equations.