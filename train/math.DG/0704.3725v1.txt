In this paper we examine the structure of Riemannian manifolds with a special kind of Codazzi tensors. We use them to construct globally hyperbolic Lorentzian manifolds with complete Cauchy hypersurfaces for any weakly irreducible holonomy representation with parallel spinors, i.e. with a holonomy group which is a semidirect product between \R^{n-2} and one of \1, SU(k), Sp(1), G_2 and Spin(7).