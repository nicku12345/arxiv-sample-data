In this paper we develop an abstract theory for the Codazzi equation on surfaces, and use it as an analytic tool to derive new global results for surfaces in the space forms {\bb R}^3, {\bb S}^3 and {\bb H}^3. We give essentially sharp generalizations of some classical theorems of surface theory that mainly depend on the Codazzi equation, and we apply them to the study of Weingarten surfaces in space forms. In particular, we study existence of holomorphic quadratic differentials, uniqueness of immersed spheres in geometric problems, height estimates, and the geometry and uniqueness of complete or properly embedded Weingarten surfaces.