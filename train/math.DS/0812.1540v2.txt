We introduce the notion of nonuniform center bunching for partially hyperbolic diffeomorphims, and extend previous results by Burns--Wilkinson and Avila--Santamaria--Viana. Combining this new technique with other constructions, we prove that C^1-generic partially hyperbolic symplectomorphisms are ergodic. We also construct new examples of stably ergodic partially hyperbolic diffeomorphisms.