According to the Furstenberg-Zimmer structure theorem, every measure-preserving system has a maximal distal factor, and is weak mixing relative to that factor. Furstenberg and Katznelson used this structural analysis of measure-preserving systems to provide a perspicuous proof of Szemer\'edi's theorem. Beleznay and Foreman showed that, in general, the transfinite construction of the maximal distal factor of a separable measure-preserving system can extend arbitrarily far into the countable ordinals. Here we show that the Furstenberg-Katznelson proof does not require the full strength of the maximal distal factor, in the sense that the proof only depends on a combinatorial weakening of its properties. We show that this combinatorially weaker property obtains fairly low in the transfinite construction, namely, by the \omega^{\omega^\omega}th level.