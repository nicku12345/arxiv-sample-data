The Yoccoz puzzle is a fundamental tool in Holomorphic Dynamics. The original combinatorial argument by Yoccoz, based on the Branner-Hubbard tableau, counts the preimages of a non-degenerate annulus in the puzzle. However, in some important new applications of the puzzle (notably, matings of quadratic polynomials) there is no non-degenerate annulus. We develop a general combinatorial argument to handle this situation. It allows to derive corollaries, such as the local connectedness of the Julia set, for suitable families of rational maps.