In this work we obtain a new criterion to establish ergodicity and non-uniform hyperbolicity of smooth measures of diffeomorphisms. This method allows us to give a more accurate description of certain ergodic components. The use of this criterion in combination with topological devices such as blenders lets us obtain global ergodicity and abundance of non-zero Lyapunov exponents in some contexts. In the partial hyperbolicity context, we obtain that stably ergodic diffeomorphisms are C^1-dense among volume preserving partially hyperbolic diffeomorphisms with two-dimensional center bundle. This is motivated by a well known conjecture of C. Pugh and M. Shub.