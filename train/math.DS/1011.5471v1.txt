For perturbations of integrable Hamiltonians systems, the Nekhoroshev theorem shows that all solutions are stable for an exponentially long interval of time, provided the integrable part satisfies a steepness condition and the system is analytic. This fundamental result has been extended in two distinct directions. The first one is due to Niederman, who showed that under the analyticity assumption, the result holds true for a prevalent class of integrable systems which is much wider than the steep systems. The second one is due to Marco-Sauzin but it is limited to quasi-convex integrable systems, for which they showed exponential stability if the system is assumed to be only Gevrey regular. If the system is finitely differentiable, the author showed polynomial stability, still in the quasi-convex case. The goal of this work is to generalize all these results in a unified way, by proving exponential or polynomial stability for Gevrey or finitely differentiable perturbations of prevalent integrable Hamiltonian systems.