We develop a very general operator-valued functional calculus for operators with an H^{\infty}-calculus. We then apply this to the joint functional calculus of two commuting sectorial operators when one has an H^{\infty}calculus. Using this we prove theorem of Dore-Venni type on sums of commuting sectorial operators and apply our results to the problem of L_p-maximal regularity. Our main assumption is the R-boundedness of certain sets of operators, and therefore methods from the geometry of Banach spaces are essential here. In the final section we exploit the special Banach space structure of L_1-spaces and C(K)-spaces, to obtain some more detailed results in this setting.