The main result of this paper is the existence of a hyperinvariant subspace of weighted composition operator Tf=vf\circ\tau on L^p([0,1]^d), (1 \leq p \leq \infty) when the weight v is in the class of ``generalized polynomials'' and the composition map is a bijective ergodic transform satisfying a given discrepancy. The work is based on the construction of a functional calculus initiated by Wermer and generalized by Davie.