Let X be a set of analytic functions on the open unit disk D, and let phi be an analytic function on D such that phi(D) is contained in D and f |-> f o phi takes X into itself. We present conditions on X ensuring that if f |-> f o phi is invertible on X, then phi is an automorphism of D, and we derive a similar result for mappings of the form f |-> psi.(f o phi), where psi is some analytic function on D. We obtain as corollaries of this purely function-theoretic work, new results concerning invertibility of composition operators and weighted composition operators on Banach spaces of analytic functions such as S^p and the weighted Hardy spaces H^2(beta).