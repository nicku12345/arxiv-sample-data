In the 1950s L. Schwartz proved his famous impossibility result: for every k in N there does not exist a differential algebra (A,+,*,D) in which the distributions can be embedded, where D is a linear operator that extends the distributional derivative and satisfies the Leibnitz rule (namely D(u*v)=Du*v+u*Dv) and * is an extension of the pointwise product on the continuous functions. In this paper we prove that, by changing the requests, it is possible to avoid the impossibility result of Schwartz. Namely we prove that it is possible to construct an algebra of functions (A,+,*,D) such that (1) the distributions can be embedded in A in such a way that the restriction of the product to the C^{1} functions agrees with the pointwise product, namely for every f,g in C^{1} we have   {\Phi}(fg)={\Phi}(f)*{\Phi}(g), and (2) there exists a linear operator D:A\rightarrow A that extends the distributional derivative and satisfies a weak form of the Leibnitz rule. The algebra that we construct is an algebra of restricted ultrafunction, which are generalized functions defined on a subset {\Sigma} of a non-archimedean field K (with {\Sigma}\subseteq R\subseteq K) and with values in K. To study the restricted ultrafunctions we will use some techniques of nonstandard analysis.