The application of generalized inverses is usually neglected in pure mathematical research. However, it is very effective for this paper. We expand the famous matrix rank theorem due to R. Penrose to operators between Banach paces. Therefore a modern perturbation analysis of generalized inverses is built. Hereby, we find and prove a complete rank theorem in advanced calculus. So a complete answer to the rank theorem problem presented by M. S. Berger is given. Applying the co-final set and the perturbation analysis of generalized inverses we prove the Frobenius theorem in Banach space, in the proof of which the used vector field and flow theory are avoided. The co-final set is essential to the Frobenius theorem. When the co-final set is trivial, the theorem reduces to the differential equation with initial value in Banach space. Also, we discuss a non-trivial family of subspaces and give its smooth integral submanifold.