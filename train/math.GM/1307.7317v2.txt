All the spaces considered are over \bbc. Z represents any Banach space, L(Z) the space of all the bounded operators on Z, and H any Hilbert space. We will prove that for any unital proper weakly closed subalgebra (upwcsa) R\subsetneq L(Z), the algebra R^\p=\{A^* \st A\in R\} has nontrivial invariant subspaces (ntinvss). This solves in \lb particular, the three most famous long standing open problems in operator theory, (1) the transitive algebra problem, (2) the hyperinvariant subspace problem, and (3) the invariant subspace problem. The transitive algebra problem was raised by R. V. Kadison in 1955 and it asks if every upwcsa of L(H) has ntinvss. This proves also a conjecture of P. Enflo, that every operator on a reflexive space has ntinvss and a conjecture of V. I. Lomonosov, that the adjoint of any Banach space operator has ntinvss.