We give a necessary and sufficient condition, in terms of a certain reflection principle, for every unconditionally closed subset of a group G to be algebraic. As a corollary, we prove that this is always the case when G is a direct product of an Abelian group with a direct product (sometimes also called a direct sum) of a family of countable groups. This is the widest class of groups known to date where the answer to the 63 years old problem of Markov turns out to be positive. We also prove that whether every unconditionally closed subset of G is algebraic or not is completely determined by countable subgroups of G.