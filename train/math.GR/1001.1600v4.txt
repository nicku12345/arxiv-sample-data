We determine all finite p-groups that admit a faithful, self-similar action on the p-ary rooted tree such that the first level stabilizer is abelian. A group is in this class if and only if it is a split extension of an elementary abelian p-group by a cyclic group of order p.   The proof is based on use of virtual endomorphisms. In this context the result says that if G is a finite p-group with abelian subgroup H of index p, then there exists a virtual endomorphism of G with trivial core and domain H if and only if G is a split extension of H and H is an elementary abelian p-group.