We introduce new methods from p-adic integration into the study of representation zeta functions associated to compact p-adic analytic groups and arithmetic groups. They allow us to establish that the representation zeta functions of generic members of families of p-adic analytic pro-p groups obtained from a global, `perfect' Lie lattice satisfy functional equations. In the case of `semisimple' compact p-adic analytic groups, we exhibit a link between the relevant p-adic integrals and a natural filtration of the locus of irregular elements in the associated semisimple Lie algebra, defined by centraliser dimension.   Based on this algebro-geometric description, we compute explicit formulae for the representation zeta functions of principal congruence subgroups of the groups SL_3(O), where O is a compact discrete valuation ring of characteristic 0, and of the corresponding unitary groups. These formulae, combined with approximative Clifford theory, allow us to determine the abscissae of convergence of representation zeta functions associated to arithmetic subgroups of algebraic groups of type A_2. Assuming a conjecture of Serre on the Congruence Subgroup Problem, we thereby prove a conjecture of Larsen and Lubotzky on lattices in higher-rank semisimple groups for algebraic groups of type A_2 defined over number fields.