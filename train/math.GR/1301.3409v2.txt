Suppose that a finite group G admits a Frobenius group of automorphisms FH of coprime order with cyclic kernel F and complement H such that the fixed point subgroup C_G(H) of the complement is nilpotent of class c. It is proved that G has a nilpotent characteristic subgroup of index bounded in terms of c, |C_G(F)|, and |FH| whose nilpotency class is bounded in terms of c and |H| only. This generalizes the previous theorem of the authors and P. Shumyatsky, where for the case of C_G(F)=1 the whole group was proved to be nilpotent of (c,|H|)-bounded class. Examples show that the condition of F being cyclic is essential. B. Hartley's theorem based on the classification provides reduction to soluble groups. Then representation theory arguments are used to bound the index of the Fitting subgroup. Lie ring methods are used for nilpotent groups. A similar theorem on Lie rings with a metacyclic Frobenius group of automorphisms FH is also proved.