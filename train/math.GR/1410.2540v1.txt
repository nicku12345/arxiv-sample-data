We prove Wise's W-cycles conjecture. Consider a compact graph \Gamma' immering into another graph \Gamma. For any immersed cycle \Lambda:S^1\to \Gamma, we consider the map \Lambda' from the circular components \mathbb{S} of the pullback to \Gamma'. Unless \Lambda' is reducible, the degree of the covering map \mathbb{S}\to S^1 is bounded above by minus the Euler characteristic of \Gamma'. As a consequence, we obtain a homological version of coherence for one-relator groups.