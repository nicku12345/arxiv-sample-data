Let G be a finite group and Irr(G) the set of irreducible complex characters of G. Let e_p(G) be the largest integer such that p^{e_p(G)} divides \chi(1) for some \chi \in Irr(G). We show that |G:\mathbf{F}(G)|_p \leq p^{k e_p(G)} for a constant k. This settles a conjecture of A. Moret\'o. We also study the related problems of the p-parts of conjugacy class sizes of finite groups.