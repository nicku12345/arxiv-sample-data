Let g be an element of a group G. For a positive integer n, let E_n(g) be the subgroup generated by all commutators [...[[x,g],g],\dots ,g] over x\in G, where g is repeated n times. We prove that if G is a profinite group such that for every g\in G there is n=n(g) such that E_n(g) is finite, then G has a finite normal subgroup N such that G/N is locally nilpotent. The proof uses the Wilson--Zelmanov theorem saying that Engel profinite groups are locally nilpotent. In the case of a finite group G, we prove that if, for some n, |E_n(g)|\leq m for all g\in G, then the order of the nilpotent residual \gamma _{\infty}(G) is bounded in terms of m.