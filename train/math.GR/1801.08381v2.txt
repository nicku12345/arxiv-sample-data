Consider \operatorname{Sym}(n), endowed with the normalized Hamming metric d_n. A finitely-generated group \Gamma is \emph{P-stable} if every almost homomorphism \rho_{n_k}\colon \Gamma\rightarrow\operatorname{Sym}(n_k) (i.e., for every g,h\in\Gamma, \lim_{k\rightarrow\infty}d_{n_k}( \rho_{n_k}(gh),\rho_{n_k}(g)\rho_{n_k}(h))=0) is close to an actual homomorphism \varphi_{n_k} \colon\Gamma\rightarrow\operatorname{Sym}(n_k). Glebsky and Rivera observed that finite groups are P-stable, while Arzhantseva and P\u{a}unescu showed the same for abelian groups and raised many questions, especially about P-stability of amenable groups. We develop P-stability in general, and in particular for amenable groups. Our main tool is the theory of invariant random subgroups (IRS), which enables us to give a characterization of P-stability among amenable groups, and to deduce stability and instability of various families of amenable groups.