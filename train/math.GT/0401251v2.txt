We present an alternative definition for the Goussarov--Habiro filtration of the Z-module freely generated by oriented integral homology 3-spheres, by means of Lagrangian-preserving homology handlebody replacements (LP-surgeries). Garoufalidis, Goussarov and Polyak proved that the graded space (G_n)_n associated to this filtration is generated by Jacobi diagrams. Here, we express elements associated to LP-surgeries as explicit combinations of these Jacobi diagrams in (G_n)_n. The obtained coefficient in front of a Jacobi diagram is computed like its weight system with respect to a Lie algebra equipped with a non-degenerate invariant bilinear form, where cup products in 3-manifolds play the role of the Lie bracket and the linking number replaces the invariant form. In particular, this article provides an algebraic version of the graphical clover calculus developed by Garoufalidis, Goussarov, Habiro and Polyak. This version induces splitting formulae for all finite type invariants of homology 3-spheres.