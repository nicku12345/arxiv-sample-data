To an oriented link in a solid torus we associate a trace graph in a thickened torus in such a way that links are isotopic if and only if their trace graphs can be related by moves of finitely many standard types. The key ingredient is a study of codimension~2 singularities of link diagrams. For closed braids with a fixed number of strands, trace graphs can be recognized up to equivalence excluding one type of moves in polynomial time with respect to the braid length.