We propose a finite dimensional variational principle on triangulated 3-manifolds so that its critical points are related to solutions to Thurston's gluing equation and Haken's normal surface equation. The action functional is the volume. This is a generalization of an earlier program by Casson and Rivin for compact 3-manifolds with torus boundary. Combining the result in this paper and the work of Futer-Gu\'eritaud, Segerman-Tillmann and Luo-Tillmann, we obtain a new finite dimensional variational formulation of the Poncare-conjecture. This provides a step toward a new proof the Poincar\'e conjecture without using the Ricci flow.