This is the author's PhD thesis, as submitted to the Princeton University. The results of this paper have already appeared in arXiv:math/0607777v4, arXiv:math/0607691 and arXiv:0901.2156.