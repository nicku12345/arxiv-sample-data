We define an invariant \nabla_G(M) of pairs M,G, where M is a 3-manifold obtained by surgery on some framed link in the cylinder S\times I, S is a connected surface with at least one boundary component, and G is a fatgraph spine of S. In effect, \nabla_G is the composition with the \iota_n maps of Le-Murakami-Ohtsuki of the link invariant of Andersen-Mattes-Reshetikhin computed relative to choices determined by the fatgraph G; this provides a basic connection between 2d geometry and 3d quantum topology. For each fixed G, this invariant is shown to be universal for homology cylinders, i.e., \nabla_G establishes an isomorphism from an appropriate vector space \bar{H} of homology cylinders to a certain algebra of Jacobi diagrams. Via composition \nabla_{G'}\circ\nabla_G^{-1} for any pair of fatgraph spines G,G' of S, we derive a representation of the Ptolemy groupoid, i.e., the combinatorial model for the fundamental path groupoid of Teichmuller space, as a group of automorphisms of this algebra. The space \bar{H} comes equipped with a geometrically natural product induced by stacking cylinders on top of one another and furthermore supports related operations which arise by gluing a homology handlebody to one end of a cylinder or to another homology handlebody. We compute how \nabla_G interacts with all three operations explicitly in terms of natural products on Jacobi diagrams and certain diagrammatic constants. Our main result gives an explicit extension of the LMO invariant of 3-manifolds to the Ptolemy groupoid in terms of these operations, and this groupoid extension nearly fits the paradigm of a TQFT. We finally re-derive the Morita-Penner cocycle representing the first Johnson homomorphism using a variant/generalization of \nabla_G.