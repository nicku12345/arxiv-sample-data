The invariant \Theta is an invariant of rational homology 3-spheres M equipped with a combing X over the complement of a point. It is related to the Casson-Walker invariant \lambda by the formula \Theta(M,X)=6\lambda(M)+p_1(X)/4, where p_1 is an invariant of combings that is simply related to a Gompf invariant. In [arXiv:1209.3219], we proved a combinatorial formula for the \Theta-invariant in terms of Heegaard diagrams, equipped with decorations that define combings, from the definition of \Theta as an algebraic intersection in a configuration space. In this article, we prove that this formula defines an invariant of pairs (M,X) without referring to configuration spaces, and we prove that this invariant is the sum of 6 \lambda(M) and p_1(X)/4 for integral homology spheres, by proving surgery formulae both for the combinatorial invariant and for p_1.