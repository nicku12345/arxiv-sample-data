A theorem of Kirby gives a necessary and sufficient condition for two framed links in S^3 to yield orientation-preserving diffeomorphic results of surgery. Kirby's theorem is an important method for constructing invariants of 3-manifolds. In this paper, we prove a variant of Kirby's theorem for null-homologous framed links in a 3-manifold. This result involves a new kind of moves, called IHX-moves, which are closely related to the IHX relation in the theory of finite type invariants. When the first homology group of M is free abelian, we give a refinement of this result to \pm1-framed, algebraically split, null-homologous framed links in M.