Cheptea, Habiro and Massuyeau constructed the LMO functor, which is defined on a certain category of cobordisms between two surfaces with at most one boundary component. In this paper, we extend the LMO functor to the case of any number of boundary components, and our functor reflects relations among the parts corresponding to the genera and boundary components of surfaces. We also discuss a relationship with finite-type invariants and Milnor invariants.