We develop a calculus for diagrams of knotted objects. We define Arrow presentations, which encode the crossing informations of a diagram into arrows in a way somewhat similar to Gauss diagrams, and more generally w-tree presentations, which can be seen as `higher order Gauss diagrams'. This Arrow calculus is used to develop an analogue of Habiro's clasper theory for welded knotted objects, which contain classical link diagrams as a subset. This provides a 'realization' of Polyak's algebra of arrow diagrams at the welded level, and leads to a characterization of finite type invariants of welded knots and long knots. As a corollary, we recover several topological results due to K. Habiro and A. Shima and to T. Watanabe on knotted surfaces in 4-space. We also classify welded string links up to homotopy, thus recovering a result of the first author with B. Audoux, P. Bellingeri and E. Wagner.