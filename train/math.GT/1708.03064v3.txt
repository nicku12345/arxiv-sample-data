A flat virtual link is a finite collection of oriented closed curves \mathfrak L on an oriented surface M considered up to virtual homotopy, i.e., a composition of elementary stabilizations, destabilizations, and homotopies. Specializing to a pair of curves (L_1,L_2), we show that the minimal number of intersection points of curves in the virtual homotopy class of (L_1, L_2) equals to the number of terms of a generalization of the Anderson--Mattes--Reshetikhin Poisson bracket. Furthermore, considering a single curve, we show that the minimal number of self-intersections of a curve in its virtual homotopy class can be counted by a generalization of the Cahn cobracket.