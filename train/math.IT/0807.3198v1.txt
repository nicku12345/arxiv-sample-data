In 1998 Hoholdt, van Lint and Pellikaan introduced the concept of a ``weight function'' defined on a F_q-algebra and used it to construct linear codes, obtaining among them the algebraic-geometric (AG) codes supported on one point. Later it was proved by Matsumoto that all codes produced using a weight function are actually AG codes supported on one point. Recently, ``near weight functions'' (a generalization of weight functions), also defined on a F_q-algebra, were introduced to study codes supported on two points. In this paper we show that an algebra admits a set of m near weight functions having a compatibility property, namely, the set is a ``complete set'', if and only if it is the ring of regular functions of an affine geometrically irreducible algebraic curve defined over F_q whose points at infinity have a total of m rational branches. Then the codes produced using the near weight functions are exactly the AG codes supported on m points. A formula for the minimum distance of these codes is presented with examples which show that in some situations it compares better than the usual Goppa bound.