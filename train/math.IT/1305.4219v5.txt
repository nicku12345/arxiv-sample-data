This paper addresses two fundamental and interrelated issues in device-to-device (D2D) enhanced cellular networks. The first issue is how D2D users should access spectrum, and we consider two choices: overlay (orthogonal spectrum between D2D and cellular UEs) and underlay (non-orthogonal). The second issue is how D2D users should choose between communicating directly or via the base station, a choice that depends on distance between the potential D2D transmitter and receiver. We propose a tractable hybrid network model where the positions of mobiles are modeled by random spatial Poisson point process, with which we present a general analytical approach that allows a unified performance evaluation for these questions. Then, we derive analytical rate expressions and apply them to optimize the two D2D spectrum sharing scenarios under a weighted proportional fair utility function. We find that as the proportion of potential D2D mobiles increases, the optimal spectrum partition in the overlay is almost invariant (when D2D mode selection threshold is large) while the optimal spectrum access factor in the underlay decreases. Further, from a coverage perspective, we reveal a tradeoff between the spectrum access factor and the D2D mode selection threshold in the underlay: as more D2D links are allowed (due to a more relaxed mode selection threshold), the network should actually make less spectrum available to them to limit their interference.