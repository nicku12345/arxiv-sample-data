We use elementary methods to compute the L2-dimension of the eigenspaces of the Markov operator on the lamplighter group and of generalizations of this operator on other groups. In particular, we give a transparent explanation of the spectral measure of the Markov operator on the lamplighter group found by Grigorchuk-Zuk. The latter result was used by Grigorchuk-Linnell-Schick-Zuk to produce a counterexample to a strong version of the Atiyah conjecture about the range of L2-Betti numbers. We use our results to construct manifolds with certain L2-Betti numbers (given as convergent infinite sums of rational numbers) which are not obviously rational, but we have been unable to determine whether any of them are irrational.