We study the Andre-Quillen cohomology with coefficients of an algebra over an operad. Using resolutions of algebras coming from Koszul duality theory, we make this cohomology theory explicit and we give a Lie theoretic interpretation. For which operads is the associated Andre-Quillen cohomology equal to an Ext-functor ? We give several criterion, based on the cotangent complex, to characterize this property. We apply it to homotopy algebras, which gives a new homotopy stable property for algebras over cofibrant operads.