Freed-Hopkins-Teleman expressed the Verlinde algebra as twisted equivariant K-theory. We study how to recover the full system (fusion algebra of defect lines), nimrep (cylindrical partition function), etc of modular invariant partition functions of conformal field theories associated to loop groups. We work out several examples corresponding to conformal embeddings and orbifolds. We identify a new aspect of the A-D-E pattern of SU(2) modular invariants.