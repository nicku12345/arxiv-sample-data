In this paper, we establish the Riemann-Roch theorem in twisted K-theory extending our earlier results. As an application, we prove a twisted index formula and show that D-brane charges in Type I and Type II string theory are classified by twisted KO-theory and twisted K-theory respectively in the presence of B-fields as proposed by Witten.