This article studies the algebraic structure of homology theories defined by a left Hopf algebroid U over a possibly noncommutative base algebra A, such as for example Hochschild, Lie algebroid (in particular Lie algebra and Poisson), or group and etale groupoid (co)homology. Explicit formulae for the canonical Gerstenhaber algebra structure on Ext_U(A,A) are given. The main technical result constructs a Lie derivative satisfying a generalised Cartan-Rinehart homotopy formula whose essence is that Tor^U(M,A) becomes for suitable right U-modules M a Batalin-Vilkovisky module over Ext_U(A,A), or in the words of Nest, Tamarkin, Tsygan and others, that Ext_U(A,A) and Tor^U(M,A) form a differential calculus. As an illustration, we show how the well-known operators from differential geometry in the classical Cartan homotopy formula can be obtained. Another application consists in generalising Ginzburg's result that the cohomology ring of a Calabi-Yau algebra is a Batalin-Vilkovisky algebra to twisted Calabi-Yau algebras.