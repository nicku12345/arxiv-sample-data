Let u be a local homomorphism of noetherian local rings forming part of a commutative square vf=gu. We give some conditions on the square which imply that u is formally smooth. This result encapsulates a variety of (apparently unrelated) results in commutative algebra greatly improving some of them: Greco's theorem on descent of quasi-excellence property by finite surjective morphisms, Kunz's characterization of regular local rings in positive characteristic by means of the Frobenius homomorphism (and in fact the relative version obtained by Andre and Radu), etc. In the second part of the paper, we study a similar question for the complete intersection property instead of formal smoothness, giving also some applications.