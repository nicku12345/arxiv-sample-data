The aim of this paper is to show how zeta functions and excision in cyclic cohomology may be combined to obtain index theorems. In the first part, we obtain a local index formula for "abstract elliptic pseudodifferential operators" associated to spectral triples. This formula is notably well adapted when the zeta function has multiple poles. The second part is devoted to give a concrete realization of this formula by deriving an index theorem on the simple, but significant example of Heisenberg elliptic operators on a trivial foliation, which are in general non-elliptic but hypoelliptic. The last part contains a discussion on manifolds with conic singularity, more precisely about the regularity of spectral triples in this context.