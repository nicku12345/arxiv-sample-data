Let M be a foliated manifold and G a discrete group acting on M by diffeomorphisms mapping leaves to leaves. Then G naturally acts by automorphisms on the algebra of Heisenberg pseudodifferential operators on the foliation. Our main result is an index theorem for hypoelliptic-type operators which belong to the crossed product of the Heisenberg pseudodifferential operators with the group G. As a corollary, we get a solution to Connes-Moscovici's transverse problem in arbitrary codimensions, by exhibiting an explicit formula in terms of characteristic classes of equivariant vector bundles over M, for the Chern-Connes character associated to their hypoelliptic signature operator.