Let X be a finite set of alternatives. A choice function c is a mapping which assigns to nonempty subsets S of X an element c(S) of S. A rational choice function is one for which there is a linear ordering on the alternatives such that c(S) is the maximal element of S according to that ordering. Arrow's impossibility theorem asserts that under certain natural conditions, if there are at least three alternatives then every non-dictatorial social choice gives rise to a non-rational choice function. Gil Kalai asked if Arrow's theorem can be extended to the case when the individual choices are not rational but rather belong to an arbitrary non-trivial symmetric class of choice functions. The main theorem of this paper gives an affirmative answer in a very general setting.