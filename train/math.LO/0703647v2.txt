We analyze a natural function definable from a scale at a singular cardinal, and using this function we are able to obtain quite strong negative square-brackets partition relations at successors of singular cardinals. The proof of our main result makes use of club-guessing, and as a corollary we obtain a fairly easy proof of a difficult result of Shelah connecting weak saturation of a certain club-guessing ideal with strong failures of square-brackets partition relations. We then investigate the strength of weak saturation of such ideals and obtain some results on stationary reflection.