We generalise Jensen's result on the incompatibility of subcompactness with square. We show that alpha^+-subcompactness of some cardinal less than or equal to alpha precludes square_alpha, but also that square may be forced to hold everywhere where this obstruction is not present. The forcing also preserves other strong large cardinals. Similar results are also given for stationary reflection, with a corresponding strengthening of the large cardinal assumption involved. Finally, we refine the analysis by considering Schimmerling's hierarchy of weak squares, showing which cases are precluded by alpha^+-subcompactness, and again we demonstrate the optimality of our results by forcing the strongest possible squares under these restrictions to hold.