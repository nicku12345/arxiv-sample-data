Given a cardinal \kappa that is \lambda-supercompact for some regular cardinal \lambda\geq\kappa and assuming \GCH, we show that one can force the continuum function to agree with any function F:[\kappa,\lambda]\cap\REG\to\CARD satisfying \forall\alpha,\beta\in\dom(F) \alpha<\cf(F(\alpha)) and \alpha<\beta \implies F(\alpha)\leq F(\beta), while preserving the \lambda-supercompactness of \kappa from a hypothesis that is of the weakest possible consistency strength, namely, from the hypothesis that there is an elementary embedding j:V\to M with critical point \kappa such that M^\lambda\subseteq M and j(\kappa)>F(\lambda). Our argument extends Woodin's technique of surgically modifying a generic filter to a new case: Woodin's key lemma applies when modifications are done on the range of j, whereas our argument uses a new key lemma to handle modifications done off of the range of j on the ghost coordinates. This work answers a question of Friedman and Honzik [FH2012]. We also discuss several related open questions.