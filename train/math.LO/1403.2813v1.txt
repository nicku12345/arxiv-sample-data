In this paper we construct a Beth model for intuitionistic functionals of high types and use it to create a relatively strong theory SLP containg intuitionistic principles for functionals, in particular, the theory of the "creating subject", axioms for lawless functionals and some versions of choice axioms. We prove that the intuitionistic theory SLP is equiconsistent with a classical typed set theory TI, where the comprehension axiom for sets of type n is restricted to formulas with no parameters of types > n. We show that each fragment of SLP with types <= s is equiconsistent with the corresponding fragment of TI and that it is stronger than the previous fragment of SLP. Thus, both SLP and TI are much stronger than the second order arithmetic. By constructing the intuitionistic theory SLP and interpreting in it the classical set theory TI, we contribute to the program of justifying classical mathematics from the intuitionistic point of view.