We show that in a stable first-order theory, the failure of higher-dimensional type amalgamation can always be witnessed by algebraic structures which we call n-ary polygroupoids. This generalizes a result of Hrushovski that failures of 4-amalgamation in stable theories are witnessed by definable groupoids (which are 2-ary polygroupoids in our terminology). The n-ary polygroupoids are definable in a mild expansion of the language (adding a unary predicate for an infinite Morley sequence).