We show that every n-quasiflat in a n-dimensional CAT(0) cube complex is at finite Hausdorff distance from a finite union of n-dimensional orthants. Then we introduce a class of cube complexes, called {\em weakly special} cube complexes and show that quasi-isometries between their universal coverings preserve top dimensional flats. We use this to establish several quasi-isometry invariants for right-angled Artin groups.   Some of our arguments also extend to CAT(0) spaces of finite geometric dimension. In particular, we give a short proof of the fact that a top dimensional quasiflat in a Euclidean buildings is Hausdorff close to finite union of Weyl cones, which was previously established in several other authors by different methods.