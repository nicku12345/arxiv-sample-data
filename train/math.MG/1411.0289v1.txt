A Kokotsakis polyhedron with quadrangular base is a neighborhood of a quadrilateral in a quad surface. Generically, a Kokotsakis polyhedron is rigid. Up to now, several flexible classes were known, but a complete classification was missing. In the present paper, we provide such a classification. The analysis is based on the fact that the dihedral angles of a Kokotsakis polyhedron are related by an Euler-Chasles correspondence. It results in a diagram of elliptic curves covering complex projective planes. A polyhedron is flexible if and only if this diagram commutes.