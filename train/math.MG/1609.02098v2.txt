We give necessary and sufficient conditions that show that both the group of isometries and the group of measure-preserving isometries are Lie groups for a large class of metric measure spaces. In addition we study, among other examples, whether spaces having a generalized lower Ricci curvature bound fulfill these requirements. The conditions are satisfied by RCD*-spaces and, under extra assumptions, by CD-spaces, CD*-spaces, and MCP-spaces. However, we show that the MCP-condition by itself is not enough to guarantee a smooth behavior of these automorphism groups. More generally we show that spaces with good optimal transport properties meet as well the hypotheses.