Let A be either a complex or real matrix with all distinct eigenvalues. We propose a new method for the computation of both the unstructured and the real-structured (if the matrix is real) distance w_{\mathbb K}(A) (where {\mathbb K}=\mathbb C if general complex matrices are considered and {\mathbb K} ={\mathbb R} if only real matrices are allowed) of the matrix A from the set of defective matrices, that is the set of those matrices with at least a multiple eigenvalue with algebraic multiplicity larger than its geometric multiplicity. For 0 < \varepsilon \le w_{\mathbb K}(A), this problem is closely related to the computation of the most ill-conditioned \varepsilon-pseudoeigenvalues of A, that is points in the \varepsilon-pseudospectrum of A characterized by the highest condition number. The method we propose couples a system of differential equations on a low rank (possibly structured) manifold which computes the \varepsilon-pseudoeigenvalue of A which is closest to coalesce, with a fast Newton-like iteration aiming to determine the minimal value \varepsilon such that such an \varepsilon-pseudoeigenvalue becomes defective. The method has a local behaviour; this means that in general we find upper bounds for w_{\mathbb K}(A). However, they usually provide good approximations, in those (simple) cases where we can check this. The methodology can be extended to a structured matrix where it is required that the distance is computed within some manifold defining the structure of the matrix. In this paper we extensively examine the case of real matrices but we also consider pattern structures. As far as we know there do not exist methods in the literature able to compute such distance.