In parallel solution of partial differential equations, a complex stencil update formula that accesses multiple layers of neighboring grid points sometimes must be decomposed into atomic stages, ones that access only immediately neighboring grid points. This paper shows that this requirement can be formulated as constraints of an optimization problem, which is equivalent to the dual of a minimum-cost network flow problem. An optimized decomposition of a single stencil on one set of grid points can thereby be computed efficiently.