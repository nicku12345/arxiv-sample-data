Let p be a prime for which the congruence group \Gamma_0(p)^* is of genus zero, and j_p^* be the corresponding Hauptmodul. Let f be a nearly holomorphic modular form of weight 1/2 on \Gamma_0(4p) which satisfies some congruence condition on its Fourier coefficients. We interpret f as a vector valued modular form. Applying Borcherds lifting of vector valued modular forms we construct infinite products associated to j_p^* and extend Zagier's trace formula for singular values of j_p^*. Further we investigate the twisted traces of sigular values of j_p^* and construct Borcherds products related to them.