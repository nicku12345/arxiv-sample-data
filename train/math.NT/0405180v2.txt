We give new bounds for the number of integral points on elliptic curves. The method may be said to interpolate between approaches via diophantine techniques ([BP], [HBR]) and methods based on quasiorthogonality in the Mordell-Weil lattice ([Sil6], [GS], [He]). We apply our results to break previous bounds on the number of elliptic curves of given conductor and the size of the 3-torsion part of the class group of a quadratic field. The same ideas can be used to count rational points on curves of higher genus.