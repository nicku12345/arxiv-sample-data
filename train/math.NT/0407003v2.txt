We prove R = T theorems for certain reducible residual Galois representations. We answer in the positive a question of Gross and Lubin on whether certain Hecke algebras T are discrete valuation rings. In order to prove these results we determine (using the theory of Breuil modules) when two finite flat group schemes G and H of order p over an arbitrarily tamely ramified discrete valuation ring admit an extension not killed by p.