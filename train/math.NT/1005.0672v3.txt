We give simple proofs of the Davenport--Heilbronn theorems, which provide the main terms in the asymptotics for the number of cubic fields having bounded discriminant and for the number of 3-torsion elements in the class groups of quadratic fields having bounded discriminant. We also establish second main terms for these theorems, thus proving a conjecture of Roberts. Our arguments provide natural interpretations for the various constants appearing in these theorems in terms of local masses of cubic rings.