Let p>2 be prime. We complete the proof of the weight part of Serre's conjecture for rank two unitary groups for mod p representations in the totally ramified case, by proving that any weight which occurs is a predicted weight. Our methods are a mixture of local and global techniques, and in the course of the proof we establish some purely local results on crystalline extension classes.