We define and prove a noncommutative generalization of a formula relating the Maslov index of a triple of Lagrangian subspaces of a symplectic vector space to eta-invariants associated to a pair of Lagrangian subspaces generalizing a result of Bunke and Koch in the family case. The noncommutative Maslov index, defined for modules over a C^*-algebra \A, is an element in K_0(\A). The generalized formula calculates its Chern character in the de Rham homology of certain dense subalgebras of \A. The proof, modelled on the proof by Bunke and Koch, is a noncommutative Atiyah-Patodi-Singer index theorem for a particular Dirac operator twisted by an \A-vector bundle. We develop an analytic framework for this type of index problem.