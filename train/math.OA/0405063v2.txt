For locally compact groups G and H let A(G) denote the Fourier algebra of G and B(H) the Fourier-Stieltjes algebra of H. Any continuous piecewise affine map alpha:Y -> G (where Y is an element of the open coset ring of H) induces a completely bounded homomorphism Phi_alpha:A(G) -> B(H) by setting Phi_alpha u(.)=u(alpha(.)) on Y and Phi_alpha u=0 off of Y. We show that if G is amenable then any completely bounded homomorphism Phi:A(G) -> B(H) is of this form; and this theorem fails if G contains a discrete nonabelian free group. Our result generalises results of P.J. Cohen, B. Host and of the first author. We also obtain a description of all the idempotents in the Fourier-Stieltjes algebras which are contractive or positive definite.