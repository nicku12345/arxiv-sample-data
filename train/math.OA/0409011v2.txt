We generalise Wigner's theorem to its most general form possible for B(h) in the sense of completely characterising those vector state transformations of B(h) that appear as restrictions of duals of linear operators on B(h). We then use this result to similarly characterise the pure state transformations of general C*-algebras that appear as restrictions of duals of linear operators on the underlying algebras. This result may be interpreted as a noncommutative Banach-Stone theorem.