Ando's theorem states that any pair of commuting contractions on a Hilbert space can be dilated to a pair of commuting unitaries. Parrott presented an example showing that an analogous result does not hold for a triple of pairwise commuting contractions. We generalize both of these results as follows. Any n-tuple of contractions that commute according to a graph without a cycle can be dilated to an n-tuple of unitaries that commute according to that graph. Conversely, if the graph contains a cycle, we construct a counterexample.