Given a positive function on the set of edges of an arbitrary directed graph E=(E^0,E^1), we define a one-parameter group of automorphisms on the C*-algebra of the graph C^*(E), and study the problem of finding KMS states for this action. We prove that there are bijective correspondences between KMS states on C^*(E), a certain class of states on its core, and a certain class of tracial states on C_0(E^0). We also find the ground states for this action and give some examples.