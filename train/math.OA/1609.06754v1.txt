Kadison's Pythagorean theorem (2002) provides a characterization of the diagonals of projections with a subtle integrality condition. Arveson (2007), Kaftal, Ng, Zhang (2009), and Argerami (2015) all provide different proofs of that integrality condition. In this paper we interpret the integrality condition in terms of the essential codimension of a pair of projections introduced by Brown, Douglas and Fillmore (1973), or, equivalently of the index of a Fredholm pair of projections introduced by Avron, Seiler, and Simon (1994). The same techniques explain the integer occurring in the characterization of diagonals of selfadjoint operators with finite spectrum by Bownik and Jasper (2015).