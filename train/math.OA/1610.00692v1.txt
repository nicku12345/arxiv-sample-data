We study graph C^*-algebras equipped with generalised gauge actions, and characterise in terms of groupoids and groupoid cocycles when two graph C^*-algebras are isomorphic by a diagonal-preserving isomorphism that intertwines the generalised gauge actions. We apply this characterisation to show that two Cuntz-Krieger algebras are isomorphic by a diagonal-preserving isomorphism that intertwines the gauge actions if and only if the corresponding one-sided subshifts are eventually conjugate, and that the stabilisation of two Cuntz-Krieger algebras are isomorphic by a diagonal-preserving isomorphism that intertwines the gauge actions if and only if the corresponding two-sided subshifts are conjugate.