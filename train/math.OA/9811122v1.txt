In this paper we present a generalization of the Radon-Nikodym theorem proved by Pedersen and Takesaki. Given a normal, semifinite and faithful (n.s.f.) weight \phi on a von Neumann algebra M and a strictly positive operator \delta, affiliated with M and satisfying a certain relative invariance property with respect to the modular automorphism group \sigma^\phi of \phi, with a strictly positive operator as the invariance factor, we construct the n.s.f. weight \phi(\delta^{1/2} . \delta^{1/2}). All the n.s.f. weights on M whose modular automorphisms commute with \sigma^\phi are of this form, the invariance factor being affiliated with the centre of M. All the n.s.f. weights which are relatively invariant under \sigma^\phi are of this form, the invariance factor being a scalar.