We consider a manufacturing plant that purchases raw materials for product assembly and then sells the final products to customers. There are M types of raw materials and K types of products, and each product uses a certain subset of raw materials for assembly. The plant operates in slotted time, and every slot it makes decisions about re-stocking materials and pricing the existing products in reaction to (possibly time-varying) material costs and consumer demands. We develop a dynamic purchasing and pricing policy that yields time average profit within epsilon of optimality, for any given epsilon>0, with a worst case storage buffer requirement that is O(1/epsilon). The policy can be implemented easily for large M, K, yields fast convergence times, and is robust to non-ergodic system dynamics.