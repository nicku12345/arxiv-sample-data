Large-scale integration of plug-in electric vehicles (PEV) in power systems can cause severe issues to the existing distribution system, such as branch congestions and significant voltage drops. As a consequence, smart charging strategies are crucial for the secure and reliable operation of the power system. This paper tries to achieve high penetration level of PEVs with the existing distribution system infrastructure by proposing a smart charging algorithm that can optimally utilize the distribution system capacity. Specifically, the paper proposes a max-weight PEV dispatch algorithm to control the PEV charging rates, subject to power system physical limits. The proposed max-weight PEV dispatch algorithm is proved to be throughput optimal under very mild assumptions on the stochastic dynamics in the system. This suggests that the costly distribution system infrastructure upgrade can be avoided, or failing that, at least successfully deferred. The proposed PEV dispatch algorithm is particularly attractive in integrating the renewable energy sources in the distribution system, by successfully absorbing their intermittency.