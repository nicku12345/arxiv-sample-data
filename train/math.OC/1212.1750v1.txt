In this paper, we consider the electricity cost minimization problem in a residential network where each community is equipped with a distributed power generation source and every household in the community has a set of essential and shiftable power demands. We allow bi-directional power transactions and assume a two-tier pricing model for the buying and selling of electricity from the grid. In this situation, in order to reduce the cost of electricity we are required to make, 1) Scheduling decisions for the shiftable demands, 2) The decisions on the amount of energy purchased from the gird by the users, 3) The decisions on the amount of energy sold to the grid by the users. We formulate a global centralized optimization problem and obtain the optimal amount of electricity consumed, sold and purchased for each household, respectively by assuming the availability of all current and future values of time-varying parameters. In reality, the lack of perfect information hampers the implementation of such global centralized optimization. Hence, we propose a distributed online algorithm which only requires the current values of the timevarying supply and demand processes. We then compare and determine the tradeoff between both formulations. Simulation results show that the proposed schemes can provide effective management for household electricity usage.