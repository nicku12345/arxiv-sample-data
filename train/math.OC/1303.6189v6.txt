We study a continuous-time, finite horizon, stochastic partially reversible investment problem for a firm producing a single good in a market with frictions. The production capacity is modeled as a one-dimensional, time-homogeneous, linear diffusion controlled by a bounded variation process which represents the cumulative investment-disinvestment strategy. We associate to the investment-disinvestment problem a zero-sum optimal stopping game and characterize its value function through a free-boundary problem with two moving boundaries. These are continuous, bounded and monotone curves that solve a system of non-linear integral equations of Volterra type. The optimal investment-disinvestment strategy is then shown to be a diffusion reflected at the two boundaries.