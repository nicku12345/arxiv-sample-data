Let A be a finite subset of N^n and R[x]_A be the space of real polynomials whose monomial powers are from A. Let K be a compact basic semialgebraic set of R^n such that R[x]_A contains a polynomial that is positive on K. Denote by P_A(K) the cone of polynomials in R[x]_A that are nonnegative on K. The dual cone of P_A(K) is R_A(K), the set of all A-truncated moment sequences in R^A that admit representing measures supported in K. Our main results are: i) We study the properties of P_A(K) and R_A(K) (like interiors, closeness, duality, memberships), and construct a convergent hierarchy of semidefinite relaxations for each of them. ii) We propose a semidefinite algorithm for solving linear optimization problems with the cones P_A(K) and R_A(K), and prove its asymptotic and finite convergence; a stopping criterion is also given. iii) We show how to check whether P_A(K) and R_A(K) intersect affine subspaces; if they do, we show to get get a point in the intersections; if they do not, we prove certificates for the non-intersecting.