In future smart grids, energy storage systems (ESSs) are expected to play a key role in reducing peak hour electricity generation cost and the associated level of carbon emissions. Considering their high acquisition, operation, and maintenance costs, ESSs are likely to serve a large number of users. Hence, optimal sizing of energy ESSs plays a critical role as over-provisioning ESS size leads to under-utilizing costly assets and under-provisioning it taxes operation lifetime. This paper proposes a stochastic framework for analyzing the optimal size of energy storage systems. In this framework the demand of each customer is modeled stochastically and the aggregate demand is accommodated by a combination of power drawn from the grid and the storage unit when the demand exceed grid capacity. In this framework an analytical method is developed, which provides tractable solution to the ESS sizing problem of interest. The results indicate that significant savings in terms of ESS size can be achieved.