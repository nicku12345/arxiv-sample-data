In this paper, we introduce a new second-order directional derivative and a second-order subdifferential of Hadamard type for an arbitrary nondifferentiable function. We derive several second-order optimality conditions for a local and a global minimum and an isolated local minimum of second-order in unconstrained optimization. In particular, we obtain two types results with generalized convex functions. We also compare our conditions with the results of the recently published paper [Bednavrik, D., Pastor, K.: On second-order conditions in unconstrained optimization. Math. Program. Ser A, {\bf 113}, 283--291 (2008)] and a lot of other works, published in high level journals, and prove that they are particular cases of our necessary and sufficient ones. We prove that the necessary optimality conditions concern more functions than the lower Dini directional derivative, even the optimality conditions with the last derivative can be applied to a function, which does not belong to some special class. At last, we apply our optimality criteria for unconstrained problems to derive necessary and sufficient optimality conditions for the cone-constrained vector problems.