We provide, in a general setting, explicit solutions for optimal stopping problems that involve diffusion process and its running maximum. Our approach is to use the excursion theory for Levy processes. Since general diffusions are, in particular, not of independent increments, we use an appropriate measure change to make the process have that property. Then we rewrite the original two-dimensional problem as an infinite number of one-dimensional ones and complete the solution. We show general solution methods with explicit value functions and corresponding optimal strategies, illustrating them by some examples.