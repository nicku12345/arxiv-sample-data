This paper proposes a novel approach to integrate optimal control of perimeter intersections (i.e. to minimize local delay) into the perimeter control scheme (i.e. to optimize traffic performance at the network level). This is a complex control problem rarely explored in the literature. In particular, modeling the interaction between the network level control and the local level control has not been fully considered. Utilizing the Macroscopic Fundamental Diagram (MFD) as the traffic performance indicator, we formulate a dynamic system model, and design a Model Predictive Control (MPC) based controller coupling two competing control objectives and optimizing the performance at the local and the network level as a whole. To solve this highly non-linear optimization problem, we employ an approximation framework, enabling the optimal solution of this large-scale problem to be feasible and efficient. Numerical analysis shows that by applying the proposed controller, the protected network can operate around the desired state as expressed by the MFD, while the total delay at the perimeter is minimized as well. Moreover, the paper sheds light on the robustness of the proposed controller. This multi-scale hybrid controller is further extended to a stochastic MPC scheme, where connected vehicles (CV) serve as the only data source. Hence, low penetration rates of CVs lead to strong noises in the controller. This is a first attempt to develop a network-level traffic control methodology by using the emerging CV technology. We consider the stochasticity in traffic state estimation and the shape of the MFD. Simulation analysis demonstrates the robustness of the proposed stochastic controller, showing that efficient controllers can indeed be designed with this newly-spread vehicle technology even in the absence of other data collection schemes (e.g. loop detectors).