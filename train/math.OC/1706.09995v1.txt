The penetration of distributed renewable energy (DRE) greatly raises the risk of distribution network operation such as peak shaving and voltage stability. Battery energy storage (BES) has been widely accepted as the most potential application to cope with the challenge of high penetration of DRE. To cope with the uncertainties and variability of DRE, a stochastic day-ahead dynamic optimal power flow (DOPF) and its algorithm are proposed. The overall economy is achieved by fully considering the DRE, BES, electricity purchasing and active power losses. The rainflow algorithm-based cycle counting method of BES is incorporated in the DOPF model to capture the cell degradation, greatly extending the expected BES lifetime and achieving a better economy. DRE scenarios are generated to consider the uncertainties and correlations based on the Copula theory. To solve the DOPF model, we propose a Lagrange relaxation-based algorithm, which has a significantly reduced complexity with respect to the existing techniques. For this reason, the proposed algorithm enables much more scenarios incorporated in the DOPF model and better captures the DRE uncertainties and correlations. Finally, numerical studies for the day-ahead DOPF in the IEEE 123-node test feeder are presented to demonstrate the merits of the proposed method. Results show that the actual BES life expectancy of the proposed model has increased to 4.89 times compared with the traditional ones. The problems caused by DRE are greatly alleviated by fully capturing the uncertainties and correlations with the proposed method.