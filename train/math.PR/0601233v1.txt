We investigate excited random walks on \Z^d, d\ge 1, and on planar strips \Z\times\{0,1,...,L-1\} which have a drift in a given direction. The strength of the drift may depend on a random i.i.d. environment and on the local time of the walk. We give exact criteria for recurrence and transience, thus generalizing results by Benjamini and Wilson for once-excited random walk on \Z^d and by the author for multi-excited random walk on \Z.