This is an extended version of a series of lectures given in St Flour. It includes a discussion of relations between the occupation field of Markov loops with the corresponding free field.