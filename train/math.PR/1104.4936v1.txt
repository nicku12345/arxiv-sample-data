In this paper we study a reflected Markov-modulated Brownian motion with a two sided reflection in which the drift, diffusion coefficient and the two boundaries are (jointly) modulated by a finite state space irreducible continuous time Markov chain. The goal is to compute the stationary distribution of this Markov process, which in addition to the complication of having a stochastic boundary can also include jumps at state change epochs of the underlying Markov chain because of the boundary changes. We give the general theory and then specialize to the case where the underlying Markov chain has two states. Moreover, motivated by an application of optimal dividend strategies, we consider the case where the lower barrier is zero and the upper barrier is subject to control. In this case we generalized earlier results from the case of a reflected Brownian motion to the Markov modulated case.