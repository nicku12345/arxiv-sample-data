We introduce a homology surgery problem in dimension 3 which has the property that the vanishing of its algebraic obstruction leads to a canonical class of \pi-algebraically-split links in 3-manifolds with fundamental group \pi . Using this class of links, we define a theory of finite type invariants of 3-manifolds in such a way that invariants of degree 0 are precisely those of conventional algebraic topology and surgery theory. When finite type invariants are reformulated in terms of clovers, we deduce upper bounds for the number of invariants in terms of \pi-decorated trivalent graphs. We also consider an associated notion of surgery equivalence of \pi-algebraically split links and prove a classification theorem using a generalization of Milnor's \mu-invariants to this class of links.