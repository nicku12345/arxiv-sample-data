We describe an efficient construction of a canonical non-commutative deformation of the algebraic functions on the moduli spaces of flat connections on a Riemann surface. We show that this algebra, which is a variant of the quantum moduli algebra introduced by Alekseev-Grosse-Schomerus and Buffenoir-Roche, has a trace functional which is related to the canonical trace in the formal index theory of Fedosov and Nest-Tsygan via the Verlinde formula.