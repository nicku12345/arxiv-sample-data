Let A be a finite dimensional Hopf algebra and (H, R) a quasitriangular bialgebra. Denote by H^*_R a certain deformation of the multiplication of H^* via R. We prove that H^*_R is a quantum commutative left H\otimes H^{op cop}-module algebra. If H is the Drinfel'd double of A then H^*_R is the Heisenberg double of A. We study the relation between H^*_R and Majid's "covariantised product". We give a formula for the canonical element of the Heisenberg double of A, solution to the pentagon equation, in terms of the R-matrix of the Drinfel'd double of A. We generalize a theorem of Jiang-Hua Lu on quantum groupoids and using this and the above we obtain an example of a quantum groupoid having the Heisenberg double of A as base. If, in Richard Borcherds' concept of a "vertex group" we allow the "ring of singular functions" to be noncommutative, we prove that if A is a finite dimensional cocommutative Hopf algebra then the Heisenberg double of A is a vertex group over A. The construction and properties of H^*_R are given also for quasi-bialgebras and a definition for the Heisenberg double of a finite dimensional quasi-Hopf algebra is proposed.