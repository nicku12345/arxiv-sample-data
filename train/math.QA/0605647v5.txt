This paper gives a construction, using heat kernels, of differential forms on the moduli space of metrised ribbon graphs, or equivalently on the moduli space of Riemann surfaces with boundary. The construction depends on a manifold with a bundle of Frobenius algebras, satisfying various conditions. These forms satisfy gluing conditions which mean they form an open topological conformal field theory, i.e. a kind of open string theory.   If the integral of these forms converged, it would yield the purely quantum part of the partition function of a Chern-Simons type gauge theory. Yang-Mills theory on a four manifold arises as one of these Chern-Simons type gauge theories.