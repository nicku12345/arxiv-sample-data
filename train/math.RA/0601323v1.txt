Let L be a finite dimensional simple Lie algebra over an algebraically closed field of characteristic p>3. We prove in this paper that if all tori of maximal dimansion in the semisimple p-envelope of L are standard, the L is up to isomorphism either a Lie algebra of type A_n, B_n, C_n, D_n, E_6, E_7, E_8, F_4, G_2 or a filtered Lie algebra of Cartan type. When p>5, the assumption on tori is fulfilled automatically and our result can be restated as follows: every finite dimensional simple Lie algebra over an algebraically closee field of characteristic p>5 is either classical or of Cartan type. This theorem settles the last remaining case p=7 of the Kostrikin-Shafarevich conjecture (from 1966).