The purpose of this paper is two fold: we study the behaviour of the forgetful functor from S-modules to graded vector spaces in the context of algebras over an operad and derive from this theory the construction of combinatorial Hopf algebras. As a byproduct we obtain freeness and cofreeness results for these Hopf algebras. Let O denote the forgetful functor from S-modules to graded vector spaces. Left modules over an operad P are treated as P-algebras in the category of S-modules. We generalize the results obtained by Patras and Reutenauer in the associative case to any operad P: the functor O sends P-algebras to P-algebras. If P is a Hopf operad then O sends Hopf P-algebras to Hopf P-algebras. If the operad P is regular one gets two different structures of Hopf P-algebras in the category of graded vector spaces. We develop the notion of unital infinitesimal P-bialgebra and prove freeness and cofreeness results for Hopf algebras built from Hopf operads. Finally, we prove that many combinatorial Hopf algebras arise from our theory, as Hopf algebras on the faces of the permutohedra and associahedra.