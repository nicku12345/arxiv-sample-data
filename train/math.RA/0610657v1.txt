Let H be a Hopf algebra and A an H-simple right H-comodule algebra. It is shown that under certain hypotheses every (H,A)-Hopf module is either projective or free as an A-module and A is either a quasi-Frobenius or a semisimple ring. As an application it is proved that every weakly finite (in particular, every finite dimensional) Hopf algebra is free both as a left and a right module over its finite dimensional right coideal subalgebras, and the latter are Frobenius algebras. Similar results are obtained for H-simple H-module algebras.