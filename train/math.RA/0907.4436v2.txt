Given an arbitrary field K and non-zero scalars a and b, we give necessary and sufficient conditions for a matrix A in M_n(K) to be a linear combination of two idempotents with coefficients a and b. This extends results previously obtained by Hartwig and Putcha in two ways: the field K considered here is arbitrary (possibly of characteristic 2), and the case a is different from b and -b is taken into account.