We prove a series of conjectures of Enomoto and Kashiwara on canonical bases and branching rules of affine Hecke algebras of type B. The main ingredient of the proof is a new graded Ext-algebra associated with quiver with involutions that we compute explicitly.