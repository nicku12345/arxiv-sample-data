Braverman and Finkelberg have recently proposed a conjectural analogue of the geometric Satake isomorphism for untwisted affine Kac-Moody groups. As part of their model, they conjecture that (at dominant weights) Lusztig's q-analog of weight multiplicity is equal to the Poincare series of the principal nilpotent filtration of the weight space, as occurs in the finite-dimensional case. We show that the conjectured equality holds for all affine Kac-Moody algebras if the principal nilpotent filtration is replaced by the principal Heisenberg filtration. The main body of the proof is a Lie algebra cohomology vanishing result. We also give an example to show that the Poincare series of the principal nilpotent filtration is not always equal to the q-analog of weight multiplicity. Finally, we give some partial results for indefinite Kac-Moody algebras.