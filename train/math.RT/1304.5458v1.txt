We classify all simple W_n-modules with finite-dimensional weight spaces. Every such module is either of a highest weight type or is a quotient of a module of tensor fields on a torus, which was conjectured by Eswara Rao. This generalizes the classical result of Mathieu on simple weight modules for the Virasoro algebra. In our proof of the classification we construct a functor from the category of cuspidal W_n-modules to the category of W_n-modules with a compatible action of the algebra of functions on a torus. We also present a new identity for certain quadratic elements in the universal enveloping algebra of W_1, which provides important information about cuspidal W_1-modules.