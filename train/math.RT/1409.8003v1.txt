This is an expanded version of my Shaw Prize Lecture delivered at the Chinese University of Hong Kong.