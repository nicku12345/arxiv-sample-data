We study the cohomological Hall algebra Y of a lagrangian substack of the moduli stack of representations of the preprojective algebra of an arbitrary quiver Q, and their actions on the cohomology of Nakajima quiver varieties. We prove that Y is pure and we compute its Poincare polynomials in terms of (nilpotent) Kac polynomials. We also provide a family of algebra generators. We conjecture that Y is equal, after a suitable extension of scalars, to the Yangian introduced by Maulik and Okounkov. As a corollary, we prove a variant of Okounkov's conjecture, which is a generalization of the Kac conjecture relating the constant term of Kac polynomials to root multiplicities of Kac-Moody algebras.