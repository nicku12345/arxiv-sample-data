Formulas for the product of an irreducible character \chi_\lambda of a complex Lie group and a deformation of the Weyl denominator as a sum over the crystal \mathcal{B}(\lambda+\rho) go back to Tokuyama. We study the geometry underlying such formulas using the expansion of spherical Whittaker functions of p-adic groups as a sum over the canonical basis \mathcal{B}(-\infty), which we show may be understood as arising from tropicalization of certain toric charts that appear in the theory of total positivity and cluster algebras. We use this to express the terms of the expansion in terms of the corresponding Mirkovi\'{c}-Vilonen polytope.   In this non-archimedean setting, we identify resonance as the appropriate analogue of total positivity, and introduce \emph{resonant Mirkovi\'{c}-Vilonen polytopes} as the corresponding geometric context. Focusing on the exceptional group G_2, we show that these polytopes carry new crystal graph structures which we use to compute a new Tokuyama-type formula as a sum over \mathcal{B}(\lambda+\rho) plus a geometric error term coming from finitely many crystals of resonant polytopes.