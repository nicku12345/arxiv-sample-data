The Gopakumar-Vafa conjecture predicts that the Gromov-Witten invariants of a Calabi-Yau 3-fold can be canonically expressed in terms of integer invariants called BPS numbers. Using the methods of symplectic Gromov-Witten theory, we prove that the Gopakumar-Vafa formula holds for any symplectic Calabi-Yau 6-manifold, and hence for Calabi-Yau 3-folds. The results extend to all symplectic 6-manifolds and to the genus zero GW invariants of semipositive manifolds.