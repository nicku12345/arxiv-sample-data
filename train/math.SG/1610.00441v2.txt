The Weil-Kostant integrality theorem states that given a smooth manifold endowed with an integral complex closed 2-form, then there exists a line bundle with connection on this manifold with curvature the given 2-form. It also characterises the moduli space of line bundles with connection that arise in this way. This theorem was extended to the case of p-forms by Gajer in [Ga]. In this paper we provide a generalization of this theorem where we replace the original manifold by a derived smooth Artin stack. Our derived Artin stacks are geometric stacks on the \'etale (\infty,1)-site of affine derived smooth manifolds. We introduce the notion of a n-shifted p-preplectic derived smooth Artin stack in analogy with the algebraic case constructed by Pantev-To\"en-Vaqui\'e-Vezzosi in [PTVV]. This is a derived smooth Artin stack endowed with a complex closed (p+1)-form which has been cohomologically shifted by degree n. It is a far reaching generalization of a p-preplectic manifold which includes orbifolds and other highly singular objects. We then show that when its n-shifted p-preplectic form is integral, then there exists a (p+n-1)-gerbe with p-connection data and curvature corresponding to the original p-preplectic form. We also provide the characterization of the moduli stack of gerbes with connections arising in this context. We construct a canonical functor from the (\infty,1)-category of integral n-shifted p-preplectic derived smooth Artin stacks to the (\infty,1)-category of linear (\infty,p+n-1)-categories. When n=0 and p=1, this functor can be thought of like a cohomology functor in that it associates to a derived presymplectic smooth Artin stack a linear invariant in the form of a differential graded module. In the general case we obtain higher prequantum categories which requires the machinery of linear (\infty,n)-categories.