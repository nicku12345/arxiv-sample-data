In this paper we obtain exact normal forms with functional invariants for local diffeomorphisms, under the action of the symplectomorphism group in the source space. Using these normal forms we obtain exact classification results for the first occurring singularities of Hamiltonian systems with one-sided constraints, a problem posed by R. B. Melrose in his studies of glancing hypersurfaces.