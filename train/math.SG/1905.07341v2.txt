This paper is essentially made of the three preprints arXiv:1212.5818, arXiv:1311.0187, arXiv:1603.07876 gathered in a single text, with simplified proofs. We recall several results of the microlocal theory of sheaves of Kashiwara-Schapira and apply them to study the symplectic geometry of cotangent bundles. We explain how we can recover the Gromov nonsqueezing theorem, the Gromov-Eliashberg rigidity theorem, the existence of graph selectors, we prove a three cusps conjecture about curves on the sphere and we recover more recent results on the topology of exact Lagrangian submanifolds of cotangent bundles.