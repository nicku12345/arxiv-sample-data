We show that every R-diagonal operator x has a continuous family of invariant subspaces relative to the von Neumann algebra generated by x. This allows us to find the Brown measure of x and to find a new conceptual proof that Voiculescu's S-transform is multiplicative. Our considerations base on a new concept of R-diagonality with amalgamation, for which we give several equivalent characterizations.