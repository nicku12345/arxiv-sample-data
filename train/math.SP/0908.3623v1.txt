This is a continuation of our paper \cite{AP2}. We prove that for functions f in the H\"older class \L_\a(\R) and 1<p<\be, the operator f(A)-f(B) belongs to \bS_{p/\a}, whenever A and B are self-adjoint operators with A-B\in\bS_p. We also obtain sharp estimates for the Schatten--von Neumann norms \big\|f(A)-f(B)\big\|_{\bS_{p/\a}} in terms of \|A-B\|_{\bS_p} and establish similar results for other operator ideals. We also estimate Schatten--von Neumann norms of higher order differences \sum\limits_{j=0}^m(-1)^{m-j}(m\j)f\big(A+jK\big). We prove that analogous results hold for functions on the unit circle and unitary operators and for analytic functions in the unit disk and contractions. Then we find necessary conditions on f for f(A)-f(B) to belong to \bS_q under the assumption that A-B\in\bS_p. We also obtain Schatten--von Neumann estimates for quasicommutators f(A)Q-Qf(B), and introduce a spectral shift function and find a trace formula for operators of the form f(A-K)-2f(A)+f(A+K).