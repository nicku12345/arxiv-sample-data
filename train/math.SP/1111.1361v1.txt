We present new results on the block-diagonalization of Dirac operators on three-dimensional Euclidean space with unbounded potentials. Classes of admissible potentials include electromagnetic potentials with strong Coulomb singularities and more general matrix-valued potentials, even non-self-adjoint ones. For the Coulomb potential, we achieve an exact diagonalization up to nuclear charge Z=124 and prove the convergence of the Douglas-Kroll-He\ss\ approximation up to Z=62, thus improving the upper bounds Z=93 and Z=51, respectively, by H.\ Siedentop and E.\ Stockmeyer considerably. These results follow from abstract theorems on perturbations of spectral subspaces of operators with gaps, which are based on a method of H.\ Langer and C.\ Tretter and are also of independent interest.