We consider the difference f(H_1)-f(H_0) for self-adjoint operators H_0 and H_1 acting in a Hilbert space. We establish a new class of estimates for the operator norm and the Schatten class norms of this difference. Our estimates utilise ideas of scattering theory and involve conditions on H_0 and H_1 in terms of the Kato smoothness. They allow for a much wider class of functions f (including some unbounded ones) than previously available results do. As an important technical tool, we propose a new notion of Schatten class valued smoothness and develop a new framework for double operator integrals.