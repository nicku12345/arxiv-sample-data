We consider the difference f(H_1)-f(H_0), where H_0=-\Delta and H_1=-\Delta+V are the free and the perturbed Schr\"odinger operators in L^2(\mathbb R^d), and V is a real-valued short range potential. We give a sharp sufficient condition for this difference to belong to a given Schatten class \mathbf S_p, depending on the rate of decay of the potential and on the smoothness of f (stated in terms of the membership in a Besov class). In particular, for p>1 we allow for some unbounded functions f.