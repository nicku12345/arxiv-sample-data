In many epidemiological contexts, disease occurrences and their rates are naturally modelled by counting processes and their intensities, allowing an analysis based on martingale methods. These methods lend themselves to extensions of nested case-control sampling designs where general methods of control selection can be easily incorporated. This same methodology allows for extensions of the Mantel-Haenszel estimator in two main directions. First, a variety of new sampling designs can be incorporated which can yield substantial efficiency gains over simple random sampling. Second, the extension allows for the treatment of multiple level time dependent exposures.