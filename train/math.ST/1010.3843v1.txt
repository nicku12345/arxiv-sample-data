In this paper, the maximal nonlinear conditional correlation of two random vectors X and Y given another random vector Z, denoted by \rho_1(X,Y|Z), is defined as a measure of conditional association, which satisfies certain desirable properties. When Z is continuous, a test for testing the conditional independence of X and Y given Z is constructed based on the estimator of a weighted average of the form \sum_{k=1}^{n_Z}f_Z(z_k)\rho^2_1(X,Y|Z=z_k), where f_Z is the probability density function of Z and the z_k's are some points in the range of Z. Under some conditions, it is shown that the test statistic is asymptotically normal under conditional independence, and the test is consistent.