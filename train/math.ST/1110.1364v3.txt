Estimating the number of spikes in a spiked model is an important problem in many areas such as signal processing. Most of the classical approaches assume a large sample size n whereas the dimension p of the observations is kept small. In this paper, we consider the case of high dimension, where p is large compared to n. The approach is based on recent results of random matrix theory. We extend our previous results to a more difficult situation where some spikes are equal, and compare our algorithm to an existing benchmark method.