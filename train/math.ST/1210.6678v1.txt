Motivated by a study about prompt coronary angiography in myocardial infarction, we propose a method to estimate the causal effect of a treatment in two-arm experimental studies with possible non-compliance in both treatment and control arms. The method is based on a causal model for repeated binary outcomes (before and after the treatment), which includes individual covariates and latent variables for the unobserved heterogeneity between subjects. Moreover, given the type of non-compliance, the model assumes the existence of three subpopulations of subjects: compliers, never-takers, and always-takers. The model is estimated by a two-step estimator: at the first step the probability that a subject belongs to one of the three subpopulations is estimated on the basis of the available covariates; at the second step the causal effects are estimated through a conditional logistic method, the implementation of which depends on the results from the first step. Standard errors for this estimator are computed on the basis of a sandwich formula. The application shows that prompt coronary angiography in patients with myocardial infarction may significantly decrease the risk of other events within the next two years, with a log-odds of about -2. Given that non-compliance is significant for patients being given the treatment because of high risk conditions, classical estimators fail to detect, or at least underestimate, this effect.