Suppose that we intend to perform an experiment consisting of a set of independent trials. The mean value of the response of each trial is assumed to be equal to the sum of the effect of the treatment selected for the trial, and some nuisance effects, e.g., the effect of a time trend, or blocking. In this model, we examine optimal approximate designs for the estimation of a system of treatment contrasts, with respect to a wide range of optimality criteria.   We show that it is necessary for any optimal design to attain the optimal treatment proportions, which may be obtained from the marginal model that excludes the nuisance effects. Moreover, we prove that for a design to be optimal, it is sufficient that it attains the optimal treatment proportions and satisfies conditions of resistance to nuisance effects. For selected natural choices of treatment contrasts and optimality criteria, we calculate the optimal treatment proportions and give an explicit form of optimal designs. In particular, we obtain optimal treatment proportions for comparison of a set of new treatments with a set of controls. The results allow us to construct a method of calculating optimal approximate designs with a small support by means of linear programming. As a consequence, we can construct efficient exact designs by a simple heuristic.